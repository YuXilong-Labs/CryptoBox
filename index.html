<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CryptoBox — 全能加解密工具箱</title>

<!-- Favicon -->
<link rel="icon" type="image/svg+xml" href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNTYgMjU2Ij48ZGVmcz48bGluZWFyR3JhZGllbnQgaWQ9ImciIHgxPSIwJSIgeTE9IjAlIiB4Mj0iMTAwJSIgeTI9IjEwMCUiPjxzdG9wIG9mZnNldD0iMCUiIHN0eWxlPSJzdG9wLWNvbG9yOiNGREU2OEEiLz48c3RvcCBvZmZzZXQ9IjEwMCUiIHN0eWxlPSJzdG9wLWNvbG9yOiNEOTc3MDYiLz48L2xpbmVhckdyYWRpZW50PjxsaW5lYXJHcmFkaWVudCBpZD0iYyIgeDE9IjAlIiB5MT0iMCUiIHgyPSIwJSIgeTI9IjEwMCUiPjxzdG9wIG9mZnNldD0iMCUiIHN0eWxlPSJzdG9wLWNvbG9yOiMyMkQzRUUiLz48c3RvcCBvZmZzZXQ9IjEwMCUiIHN0eWxlPSJzdG9wLWNvbG9yOiMwNkI2RDQiLz48L2xpbmVhckdyYWRpZW50PjwvZGVmcz48cGF0aCBkPSJNMTI4IDI4TDIxMiA2NFEyMjAgNjggMjIwIDc4TDIyMCAxNDhRMjIwIDIwMCAxMjggMjM4UTM2IDIwMCAzNiAxNDhMMzYgNzhRMzYgNjggNDQgNjRaIiBmaWxsPSJyZ2JhKDYsMTgyLDIxMiwwLjEpIiBzdHJva2U9InVybCgjYykiIHN0cm9rZS13aWR0aD0iMyIvPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEyOCwxMjgpIj48cGF0aCBkPSJNLTI4LC0zOEwtMjgsLTU4US0yOCwtODQgMCwtODRRMjgsLTg0IDI4LC01OEwyOCwtMzgiIGZpbGw9Im5vbmUiIHN0cm9rZT0idXJsKCNnKSIgc3Ryb2tlLXdpZHRoPSIxMCIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIi8+PHJlY3QgeD0iLTQwIiB5PSItNDIiIHdpZHRoPSI4MCIgaGVpZ2h0PSI2NCIgcng9IjEwIiBmaWxsPSJ1cmwoI2cpIi8+PGNpcmNsZSBjeD0iMCIgY3k9Ii0yMCIgcj0iOSIgZmlsbD0iIzBhMGEwZiIvPjxwYXRoIGQ9Ik0tNSwtMTNMLTcsNEw3LDRMNSwtMTMiIGZpbGw9IiMwYTBhMGYiLz48L2c+PC9zdmc+">

<!-- Google Fonts - Orbitron, Exo 2, JetBrains Mono -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Exo+2:wght@300;400;500;600;700&family=Orbitron:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">

<!-- CDN Libraries with Integrity -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.2.0/crypto-js.min.js" 
        integrity="sha512-a+SUDuwNzXDvz4XrIcXHuCf089/iJAoN4lmrXJg18XnduKK6YlDHNRalv4yd1N40OKI80tFidF+rqTFKGPoWFQ==" 
        crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bcryptjs@2.4.3/dist/bcrypt.min.js" 
        integrity="sha256-/xxtEcBxmEYahvAUfNMhBp6hCo+WSDysTcEcLp7MqkU=" 
        crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/js-sha3@0.8.0/src/sha3.min.js" 
        integrity="sha256-bKCMzOjvmIKIHOpKow37aWNJ2LOsEKF73DKcktWz6Yc=" 
        crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/noble-ed25519@2.0.0/index.js" 
        integrity="sha256-/3bF8VEJEZtE2jhJsKkLDN0G7p8PfWDgj7WZKWz0BNk=" 
        crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/sm-crypto@0.3.13/dist/index.umd.min.js" 
        integrity="sha256-qkkPL4FJ+RxZPHUJjM9HPSJFcZW3nISEqNfP3lWbT0M=" 
        crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/blake2b@2.1.4/index.js" 
        crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/blake3@2.1.7/dist/blake3.js" 
        crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/asn1js@3.0.5/build/asn1.es5.js" 
        crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/pkijs@3.0.15/build/index.js" 
        crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/jose@4.15.4/dist/browser/index.js" 
        crossorigin="anonymous"></script>

<style>
/* ═══ 新设计系统配色方案 ═══ */
:root {
  /* 主配色 */
  --primary: #1E293B;      /* 深蓝灰 */
  --secondary: #334155;    /* 中灰蓝 */
  --accent: #22C55E;       /* 活力绿 (CTA) */
  --bg: #0F172A;          /* 深海蓝黑 (Background) */
  --text: #F8FAFC;        /* 亮白文字 */
  
  /* 卡片系统 */
  --card-bg: rgba(30,41,59,0.6);
  --card-border: rgba(148,163,184,0.1);
  
  /* Neon 强调色 */
  --cyan: #00FFFF;
  --matrix-green: #00FF88;
  
  /* 语义色彩 */
  --green: #22C55E; 
  --green-light: #4ADE80; 
  --green-g: rgba(34,197,94,0.12);
  --orange: #F59E0B; 
  --orange-g: rgba(245,158,11,0.12);
  --red: #EF4444; 
  --red-g: rgba(239,68,68,0.12);
  --blue: #3B82F6; 
  --blue-g: rgba(59,130,246,0.12);
  --yellow: #EAB308; 
  --yellow-g: rgba(234,179,8,0.12);
  --pink: #EC4899; 
  --pink-g: rgba(236,72,153,0.12);
  --lime: #84CC16; 
  --lime-g: rgba(132,204,22,0.12);
  
  /* 文本层级 */
  --text-primary: #F8FAFC;
  --text-secondary: #CBD5E1;
  --text-muted: #94A3B8;
  --text-disabled: #64748B;
  
  /* 输入框系统 */
  --input-bg: rgba(15,23,42,0.8);
  --input-bg-focus: rgba(15,23,42,0.9);
  --input-border: rgba(148,163,184,0.1);
  --input-border-focus: rgba(34,197,94,0.4);
  
  /* 圆角统一 */
  --r-sm: 8px;
  --r: 12px;
  --r-lg: 16px;
  
  /* 字体系统 */
  --font-display: 'Orbitron', system-ui, sans-serif;  /* 标题字体 */
  --font-body: 'Exo 2', system-ui, sans-serif;        /* 正文字体 */
  --font-mono: 'JetBrains Mono', 'SF Mono', 'Fira Code', monospace; /* 代码字体 */
  
  /* 过渡动效 */
  --t-fast: 0.15s ease;
  --t: 0.2s ease;
  --t-slow: 0.25s ease-out;
}

/* 暗色主题优化 */
[data-theme="light"] {
  --bg: #FFFFFF;
  --primary: #1E293B;
  --secondary: #475569;
  --text: #0F172A;
  --text-secondary: #475569;
  --text-muted: #64748B;
  --card-bg: rgba(248,250,252,0.8);
  --card-border: rgba(203,213,225,0.2);
  --input-bg: rgba(248,250,252,0.9);
  --input-border: rgba(203,213,225,0.3);
}

/* ═══ 基础重置 ═══ */
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  font-size: 14px;
  scroll-behavior: smooth;
}

body {
  font-family: var(--font-body);
  background: var(--bg);
  color: var(--text);
  min-height: 100vh;
  overflow-x: hidden;
  line-height: 1.6;
}

/* 背景渐变效果 */
body::before {
  content: '';
  position: fixed;
  top: -50%;
  left: -50%;
  width: 200%;
  height: 200%;
  background: 
    radial-gradient(ellipse at 25% 25%, rgba(34,197,94,0.06) 0%, transparent 50%),
    radial-gradient(ellipse at 75% 25%, rgba(0,255,255,0.04) 0%, transparent 50%),
    radial-gradient(ellipse at 50% 75%, rgba(0,255,136,0.03) 0%, transparent 50%);
  z-index: 0;
  pointer-events: none;
}

.app {
  display: flex;
  min-height: 100vh;
  position: relative;
  z-index: 1;
}

/* ═══ 侧边栏重新设计 ═══ */
.sidebar {
  width: 260px;
  min-width: 260px;
  background: var(--bg);
  backdrop-filter: blur(20px);
  border-right: 1px solid var(--card-border);
  display: flex;
  flex-direction: column;
  position: fixed;
  top: 0;
  left: 0;
  bottom: 0;
  z-index: 100;
}

.sb-header {
  padding: 24px 20px 20px;
  border-bottom: 1px solid var(--card-border);
}

.sb-logo {
  display: flex;
  align-items: center;
  gap: 12px;
}

.sb-logo .mark {
  width: 40px;
  height: 40px;
  background: linear-gradient(135deg, var(--accent), var(--cyan));
  border-radius: var(--r);
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: 0 4px 20px rgba(34,197,94,0.3);
}

.sb-logo .mark svg {
  width: 22px;
  height: 22px;
  stroke: #fff;
  fill: none;
  stroke-width: 2;
  stroke-linecap: round;
  stroke-linejoin: round;
}

.sb-logo h1 {
  font-family: var(--font-display);
  font-size: 20px;
  font-weight: 600;
  background: linear-gradient(135deg, var(--text), var(--accent));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

.sb-logo .ver {
  font-family: var(--font-body);
  font-size: 11px;
  color: var(--text-muted);
  margin-top: 2px;
}

.sb-search {
  padding: 16px 16px;
}

.sb-search input {
  width: 100%;
  padding: 10px 12px 10px 38px;
  background: var(--input-bg);
  border: 1px solid var(--input-border);
  border-radius: var(--r);
  color: var(--text);
  font-size: 13px;
  font-family: var(--font-body);
  outline: none;
  transition: all var(--t);
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='none' stroke='%2394A3B8' stroke-width='1.5' stroke-linecap='round'%3E%3Ccircle cx='8' cy='8' r='6'/%3E%3Cline x1='12' y1='12' x2='16' y2='16'/%3E%3C/svg%3E");
  background-repeat: no-repeat;
  background-position: 12px center;
}

.sb-search input::placeholder {
  color: var(--text-muted);
}

.sb-search input:focus {
  border-color: var(--accent);
  background: var(--input-bg-focus);
  box-shadow: 0 0 0 3px rgba(34,197,94,0.1);
}

.sb-nav {
  flex: 1;
  overflow-y: auto;
  padding: 8px 12px 20px;
}

.sb-nav::-webkit-scrollbar {
  width: 6px;
}

.sb-nav::-webkit-scrollbar-thumb {
  background: var(--card-border);
  border-radius: 6px;
}

.nav-g {
  margin-bottom: 24px;
}

.nav-gl {
  font-size: 11px;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.06em;
  color: var(--text-disabled);
  padding: 16px 12px 8px;
  font-family: var(--font-body);
}

.nav-i {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 10px 12px;
  border-radius: var(--r);
  cursor: pointer;
  transition: all var(--t);
  color: var(--text-secondary);
  font-size: 14px;
  font-weight: 500;
  font-family: var(--font-body);
  position: relative;
  margin-bottom: 2px;
}

.nav-i::before {
  content: '';
  position: absolute;
  left: -4px;
  top: 50%;
  transform: translateY(-50%);
  width: 0;
  height: 0;
  background: var(--accent);
  border-radius: 0 2px 2px 0;
  transition: all var(--t);
  opacity: 0;
}

.nav-i:hover {
  background: rgba(34,197,94,0.08);
  color: var(--text);
  transform: translateX(2px);
}

.nav-i:hover::before {
  width: 3px;
  height: 20px;
  opacity: 0.8;
}

.nav-i.active {
  background: rgba(34,197,94,0.12);
  color: var(--accent);
  transform: translateX(4px);
}

.nav-i.active::before {
  width: 3px;
  height: 24px;
  opacity: 1;
}

.nav-i .ni {
  width: 20px;
  height: 20px;
  flex-shrink: 0;
  display: flex;
  align-items: center;
  justify-content: center;
}

.nav-i .ni svg {
  width: 18px;
  height: 18px;
  stroke: currentColor;
  fill: none;
  stroke-width: 1.8;
  stroke-linecap: round;
  stroke-linejoin: round;
}

.nav-i .badge {
  margin-left: auto;
  font-size: 10px;
  padding: 2px 8px;
  border-radius: 12px;
  font-weight: 600;
  font-family: var(--font-mono);
  transition: all var(--t);
}

.nav-i .badge:not(.gm) {
  background: var(--input-bg);
  color: var(--text-muted);
}

.nav-i.active .badge:not(.gm) {
  background: rgba(34,197,94,0.2);
  color: var(--accent);
}

/* 国密标签特殊样式 */
.nav-i .badge.gm {
  background: rgba(0,255,255,0.15);
  color: var(--cyan);
}

/* 图标颜色系统 */
.nav-i .ni.c-accent svg { stroke: var(--accent); }
.nav-i .ni.c-green svg { stroke: var(--green); }
.nav-i .ni.c-orange svg { stroke: var(--orange); }
.nav-i .ni.c-cyan svg { stroke: var(--cyan); }
.nav-i .ni.c-pink svg { stroke: var(--pink); }
.nav-i .ni.c-red svg { stroke: var(--red); }
.nav-i .ni.c-yellow svg { stroke: var(--yellow); }
.nav-i .ni.c-lime svg { stroke: var(--lime); }
.nav-i .ni.c-blue svg { stroke: var(--blue); }

/* ═══ 主内容区域 ═══ */
.main {
  flex: 1;
  margin-left: 260px;
  display: flex;
  flex-direction: column;
  max-width: calc(100vw - 260px);
}

.topbar {
  height: 56px;
  border-bottom: 1px solid var(--card-border);
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0 24px;
  background: rgba(15,23,42,0.8);
  backdrop-filter: blur(24px);
  position: sticky;
  top: 0;
  z-index: 50;
}

.bc {
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 14px;
  color: var(--text-secondary);
  font-family: var(--font-body);
  font-weight: 500;
}

.bc .sep {
  color: var(--text-muted);
}

.bc .cur {
  color: var(--text);
  font-weight: 600;
}

.tb-r {
  display: flex;
  gap: 8px;
}

.tb-btn {
  padding: 8px 16px;
  border-radius: 10px;
  border: 1px solid var(--input-border);
  background: var(--input-bg);
  color: var(--text-secondary);
  font-size: 13px;
  font-weight: 500;
  cursor: pointer;
  transition: all var(--t);
  display: flex;
  align-items: center;
  gap: 6px;
  font-family: var(--font-body);
  position: relative;
}

.tb-btn:hover {
  background: var(--input-bg-focus);
  color: var(--text);
  border-color: var(--accent);
  transform: translateY(-1px);
}

.tb-btn svg {
  width: 16px;
  height: 16px;
  stroke: currentColor;
  fill: none;
  stroke-width: 1.8;
  stroke-linecap: round;
}

.content {
  flex: 1;
  padding: 48px 32px;
  max-width: 1400px;
  width: 100%;
  margin: 0 auto;
}

.page-h {
  margin-bottom: 32px;
}

.page-h h2 {
  font-family: var(--font-display);
  font-size: 28px;
  font-weight: 600;
  display: flex;
  align-items: center;
  gap: 16px;
  letter-spacing: -0.02em;
  margin-bottom: 8px;
}

.page-h h2 .hi {
  width: 48px;
  height: 48px;
  border-radius: var(--r-lg);
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
}

.page-h h2 .hi svg {
  width: 24px;
  height: 24px;
  stroke: currentColor;
  fill: none;
  stroke-width: 2;
  stroke-linecap: round;
  stroke-linejoin: round;
}

.page-h p {
  font-size: 16px;
  color: var(--text-secondary);
  font-family: var(--font-body);
  font-weight: 400;
  line-height: 1.6;
  margin-left: 64px;
}

/* ═══ 首页工作台卡片系统 ═══ */
.cat-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(360px, 1fr));
  gap: 20px;
  margin-bottom: 48px;
}

.cat-card {
  background: var(--card-bg);
  backdrop-filter: blur(12px);
  border: 1px solid var(--card-border);
  border-radius: var(--r-lg);
  padding: 28px;
  cursor: pointer;
  transition: all var(--t);
  position: relative;
  overflow: hidden;
}

.cat-card::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 3px;
  opacity: 0;
  transition: all var(--t);
  background: linear-gradient(90deg, var(--accent), var(--cyan));
}

.cat-card:hover {
  transform: translateY(-4px);
  border-color: rgba(34,197,94,0.3);
  box-shadow: 
    0 20px 40px rgba(0,0,0,0.3),
    0 0 0 1px rgba(34,197,94,0.1),
    0 8px 32px rgba(34,197,94,0.15);
}

.cat-card:hover::before {
  opacity: 1;
}

.cat-icon {
  width: 48px;
  height: 48px;
  border-radius: var(--r);
  display: flex;
  align-items: center;
  justify-content: center;
  margin-bottom: 20px;
  transition: all var(--t);
}

.cat-icon svg {
  width: 24px;
  height: 24px;
  stroke: currentColor;
  fill: none;
  stroke-width: 2;
  stroke-linecap: round;
  stroke-linejoin: round;
}

.cat-card:hover .cat-icon {
  transform: scale(1.05);
}

.cat-icon.c-accent { background: var(--green-g); color: var(--accent); }
.cat-icon.c-green { background: var(--green-g); color: var(--green); }
.cat-icon.c-orange { background: var(--orange-g); color: var(--orange); }
.cat-icon.c-cyan { background: rgba(0,255,255,0.12); color: var(--cyan); }
.cat-icon.c-pink { background: var(--pink-g); color: var(--pink); }
.cat-icon.c-red { background: var(--red-g); color: var(--red); }
.cat-icon.c-yellow { background: var(--yellow-g); color: var(--yellow); }
.cat-icon.c-blue { background: var(--blue-g); color: var(--blue); }

.cat-card h3 {
  font-family: var(--font-display);
  font-size: 18px;
  font-weight: 600;
  margin-bottom: 8px;
}

.cat-card p {
  font-size: 14px;
  color: var(--text-secondary);
  line-height: 1.6;
  margin-bottom: 16px;
}

.tags {
  display: flex;
  flex-wrap: wrap;
  gap: 6px;
}

.tag {
  padding: 4px 10px;
  border-radius: 6px;
  font-size: 11px;
  font-family: var(--font-mono);
  background: var(--input-bg);
  color: var(--text-muted);
  font-weight: 500;
}

/* ═══ 统计数字 ═══ */
.stats {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 20px;
  margin-top: 48px;
}

.stat {
  background: var(--card-bg);
  backdrop-filter: blur(12px);
  border: 1px solid var(--card-border);
  border-radius: var(--r);
  padding: 24px;
  text-align: center;
}

.stat .n {
  font-family: var(--font-display);
  font-size: 32px;
  font-weight: 700;
  letter-spacing: -0.02em;
  background: linear-gradient(135deg, var(--accent), var(--green-light));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

.stat .l {
  font-size: 12px;
  color: var(--text-muted);
  margin-top: 4px;
  font-weight: 500;
  text-transform: uppercase;
  letter-spacing: 0.05em;
}

/* ═══ 工作区组件 ═══ */
.ws {
  display: flex;
  flex-direction: column;
  gap: 24px;
}

/* Pills (Tab系统) */
.pills {
  display: flex;
  flex-wrap: wrap;
  gap: 6px;
  padding: 4px;
  background: var(--input-bg);
  border-radius: var(--r);
  border: 1px solid var(--input-border);
}

.pill {
  padding: 8px 16px;
  border-radius: 8px;
  font-size: 13px;
  font-weight: 500;
  cursor: pointer;
  transition: all var(--t);
  color: var(--text-secondary);
  border: none;
  background: transparent;
  font-family: var(--font-body);
  position: relative;
}

.pill:hover {
  color: var(--text);
  background: rgba(255,255,255,0.05);
  transform: translateY(-1px);
}

.pill.active {
  background: var(--accent);
  color: #FFFFFF;
  box-shadow: 0 4px 12px rgba(34,197,94,0.3);
  transform: translateY(-1px);
}

/* 配置区域 */
.cfg {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
  gap: 16px;
  padding: 24px;
  background: var(--card-bg);
  backdrop-filter: blur(12px);
  border: 1px solid var(--card-border);
  border-radius: var(--r);
}

.f {
  display: flex;
  flex-direction: column;
  gap: 6px;
}

.f label {
  font-size: 12px;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  color: var(--text-muted);
  font-family: var(--font-body);
}

.f select,
.f input[type="text"],
.f input[type="number"] {
  padding: 10px 12px;
  background: var(--input-bg);
  border: 1px solid var(--input-border);
  border-radius: var(--r);
  color: var(--text);
  font-size: 13px;
  font-family: var(--font-body);
  outline: none;
  transition: all var(--t);
  appearance: none;
}

.f select {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' fill='none' stroke='%2394A3B8' stroke-width='1.5' stroke-linecap='round'%3E%3Cpolyline points='2,4 6,8 10,4'/%3E%3C/svg%3E");
  background-repeat: no-repeat;
  background-position: right 10px center;
  padding-right: 32px;
}

.f select option {
  background: var(--bg);
  color: var(--text);
}

.f select:focus,
.f input:focus {
  border-color: var(--accent);
  background: var(--input-bg-focus);
  box-shadow: 0 0 0 3px rgba(34,197,94,0.1);
}

/* ═══ 输入输出系统 ═══ */
.io-g {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 20px;
}

.io {
  background: var(--card-bg);
  backdrop-filter: blur(12px);
  border: 1px solid var(--card-border);
  border-radius: var(--r);
  overflow: hidden;
  transition: all var(--t);
  position: relative;
}

.io:focus-within {
  border-color: var(--accent);
  box-shadow: 0 0 0 3px rgba(34,197,94,0.1);
}

.io-h {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 12px 16px;
  border-bottom: 1px solid var(--input-border);
  background: rgba(255,255,255,0.02);
}

.io-h .lb {
  font-size: 12px;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  color: var(--text-muted);
  display: flex;
  align-items: center;
  gap: 8px;
  font-family: var(--font-body);
}

.io-h .lb .dot {
  width: 8px;
  height: 8px;
  border-radius: 50%;
}

.io-h .acts {
  display: flex;
  gap: 4px;
}

.io-h .acts button {
  padding: 4px 10px;
  border-radius: 6px;
  border: none;
  background: transparent;
  color: var(--text-muted);
  font-size: 11px;
  cursor: pointer;
  transition: all var(--t);
  font-family: var(--font-body);
  font-weight: 500;
}

.io-h .acts button:hover {
  background: var(--input-bg);
  color: var(--text);
}

.io textarea {
  width: 100%;
  min-height: 200px;
  padding: 16px;
  background: transparent;
  border: none;
  color: var(--text);
  font-family: var(--font-mono);
  font-size: 13px;
  line-height: 1.6;
  resize: vertical;
  outline: none;
}

.io textarea::placeholder {
  color: var(--text-muted);
}

.io .out {
  min-height: 200px;
  padding: 16px;
  font-family: var(--font-mono);
  font-size: 13px;
  line-height: 1.6;
  color: var(--green-light);
  word-break: break-all;
  overflow-wrap: break-word;
}

.io .ft {
  display: flex;
  gap: 16px;
  padding: 8px 16px;
  border-top: 1px solid var(--input-border);
  font-size: 11px;
  color: var(--text-muted);
  font-family: var(--font-mono);
}

.io .ft span {
  color: var(--text-secondary);
}

.ftabs {
  display: flex;
  border-top: 1px solid var(--input-border);
}

.ftab {
  padding: 8px 16px;
  font-size: 12px;
  font-weight: 500;
  color: var(--text-muted);
  cursor: pointer;
  border-bottom: 2px solid transparent;
  transition: all var(--t);
  font-family: var(--font-body);
}

.ftab:hover {
  color: var(--text-secondary);
}

.ftab.active {
  color: var(--accent);
  border-bottom-color: var(--accent);
}

/* ═══ 按钮系统 ═══ */
.btn {
  padding: 12px 24px;
  border-radius: var(--r);
  font-size: 14px;
  font-weight: 600;
  cursor: pointer;
  transition: all var(--t);
  display: inline-flex;
  align-items: center;
  gap: 8px;
  border: none;
  font-family: var(--font-body);
  position: relative;
  overflow: hidden;
}

.btn svg {
  width: 16px;
  height: 16px;
  stroke: currentColor;
  fill: none;
  stroke-width: 2;
  stroke-linecap: round;
  stroke-linejoin: round;
}

/* 主按钮 - 绿色 */
.btn-p,
.btn-g {
  background: linear-gradient(135deg, var(--accent), var(--green));
  color: #FFFFFF;
  box-shadow: 0 4px 16px rgba(34,197,94,0.3);
}

.btn-p:hover,
.btn-g:hover {
  box-shadow: 0 8px 24px rgba(34,197,94,0.5);
  transform: translateY(-2px);
}

/* 次要按钮 */
.btn-o {
  background: var(--input-bg);
  color: var(--text-secondary);
  border: 1px solid var(--input-border);
}

.btn-o:hover {
  background: var(--input-bg-focus);
  color: var(--text);
  border-color: var(--accent);
  transform: translateY(-1px);
}

/* 交换按钮 */
.btn-sw {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  background: var(--input-bg);
  border: 1px solid var(--input-border);
  color: var(--text-muted);
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all var(--t);
}

.btn-sw:hover {
  background: var(--green-g);
  color: var(--accent);
  border-color: var(--accent);
  transform: rotate(180deg) scale(1.05);
}

.btn-sw svg {
  width: 18px;
  height: 18px;
  stroke: currentColor;
  fill: none;
  stroke-width: 1.8;
}

/* 按钮组 */
.ab {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 12px;
}

.qa {
  display: flex;
  gap: 8px;
}

.qa button {
  padding: 6px 12px;
  border-radius: 8px;
  font-size: 12px;
  font-weight: 500;
  background: var(--input-bg);
  border: 1px solid var(--input-border);
  color: var(--text-secondary);
  cursor: pointer;
  transition: all var(--t);
  font-family: var(--font-body);
  display: flex;
  align-items: center;
  gap: 6px;
}

.qa button svg {
  width: 14px;
  height: 14px;
  stroke: currentColor;
  fill: none;
  stroke-width: 1.8;
  stroke-linecap: round;
}

.qa button:hover {
  border-color: var(--accent);
  color: var(--accent);
  transform: translateY(-1px);
}

/* ═══ 哈希结果网格 ═══ */
.hg {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 16px;
}

.hi2 {
  background: var(--card-bg);
  backdrop-filter: blur(12px);
  border: 1px solid var(--card-border);
  border-radius: var(--r);
  padding: 16px;
}

.hi2 .hl {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 8px;
}

.hi2 .hl span {
  font-size: 12px;
  font-weight: 600;
  color: var(--text-muted);
  font-family: var(--font-body);
}

.hi2 .hl .gm {
  font-size: 10px;
  background: rgba(0,255,255,0.15);
  color: var(--cyan);
  padding: 2px 6px;
  border-radius: 4px;
  font-weight: 600;
  font-family: var(--font-mono);
}

.hi2 .hl button {
  border: none;
  background: transparent;
  color: var(--text-muted);
  cursor: pointer;
  font-size: 11px;
  font-family: var(--font-body);
  font-weight: 500;
  padding: 4px 8px;
  border-radius: 4px;
  transition: all var(--t);
}

.hi2 .hl button:hover {
  background: var(--input-bg);
  color: var(--text);
}

.hi2 .hv {
  font-family: var(--font-mono);
  font-size: 12px;
  word-break: break-all;
  line-height: 1.5;
  color: var(--green-light);
}

/* ═══ Loading 和 Toast 系统 ═══ */
.toast-container {
  position: fixed;
  top: 24px;
  right: 24px;
  z-index: 9999;
  pointer-events: none;
}

.toast {
  background: var(--card-bg);
  backdrop-filter: blur(24px);
  border: 1px solid var(--card-border);
  border-radius: var(--r);
  padding: 16px 20px;
  margin-bottom: 12px;
  max-width: 360px;
  box-shadow: 0 12px 40px rgba(0,0,0,0.3);
  transform: translateX(100%);
  opacity: 0;
  transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
  pointer-events: auto;
  display: flex;
  align-items: center;
  gap: 12px;
}

.toast.show {
  transform: translateX(0);
  opacity: 1;
}

.toast.success { border-left: 4px solid var(--green); }
.toast.error { border-left: 4px solid var(--red); }
.toast.info { border-left: 4px solid var(--accent); }

.toast .toast-icon {
  width: 20px;
  height: 20px;
  flex-shrink: 0;
}

.toast .toast-icon svg {
  width: 100%;
  height: 100%;
  stroke: currentColor;
  fill: none;
  stroke-width: 2;
}

.toast.success .toast-icon { color: var(--green); }
.toast.error .toast-icon { color: var(--red); }
.toast.info .toast-icon { color: var(--accent); }

.toast .toast-text {
  font-size: 14px;
  font-weight: 500;
  color: var(--text);
  font-family: var(--font-body);
}

.toast .toast-close {
  width: 18px;
  height: 18px;
  margin-left: auto;
  color: var(--text-muted);
  cursor: pointer;
  opacity: 0.7;
  transition: opacity var(--t);
  display: flex;
  align-items: center;
  justify-content: center;
  font-family: var(--font-body);
  font-size: 16px;
  font-weight: 600;
}

.toast .toast-close:hover {
  opacity: 1;
}

/* 按钮Loading状态 */
.btn.loading {
  position: relative;
  color: transparent !important;
}

.btn.loading::after {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  width: 16px;
  height: 16px;
  margin: -8px 0 0 -8px;
  border: 2px solid currentColor;
  border-top-color: transparent;
  border-radius: 50%;
  animation: spin 0.8s linear infinite;
}

@keyframes spin {
  from { transform: rotate(0deg); }
  to { transform: rotate(360deg); }
}

/* ═══ 历史记录面板 ═══ */
.badge-count {
  position: absolute;
  top: -6px;
  right: -6px;
  background: var(--accent);
  color: #FFFFFF;
  border-radius: 50%;
  min-width: 20px;
  height: 20px;
  font-size: 10px;
  font-weight: 700;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 0 6px;
  box-shadow: 0 4px 12px rgba(34,197,94,0.4);
  font-family: var(--font-mono);
}

.history-panel {
  position: fixed;
  top: 0;
  right: 0;
  width: 420px;
  height: 100vh;
  background: rgba(15,23,42,0.95);
  backdrop-filter: blur(24px);
  border-left: 1px solid var(--card-border);
  z-index: 200;
  transform: translateX(100%);
  transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
  display: flex;
  flex-direction: column;
  box-shadow: -8px 0 40px rgba(0,0,0,0.4);
}

.history-panel.show {
  transform: translateX(0);
}

.history-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  background: rgba(0,0,0,0.6);
  backdrop-filter: blur(4px);
  z-index: 199;
  opacity: 0;
  visibility: hidden;
  transition: all 0.3s ease;
}

.history-overlay.show {
  opacity: 1;
  visibility: visible;
}

.history-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 20px 24px;
  border-bottom: 1px solid var(--card-border);
}

.history-title {
  display: flex;
  align-items: center;
  gap: 12px;
  font-size: 18px;
  font-weight: 700;
  color: var(--text);
  font-family: var(--font-display);
}

.history-title svg {
  width: 22px;
  height: 22px;
  stroke: var(--accent);
  fill: none;
  stroke-width: 2;
}

.history-actions {
  display: flex;
  gap: 8px;
}

.history-btn {
  width: 36px;
  height: 36px;
  border: none;
  background: var(--input-bg);
  border-radius: 8px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all var(--t);
  color: var(--text-muted);
}

.history-btn:hover {
  background: var(--input-bg-focus);
  color: var(--text);
  transform: translateY(-1px);
}

.history-btn svg {
  width: 16px;
  height: 16px;
  stroke: currentColor;
  fill: none;
  stroke-width: 2;
}

.history-filters {
  padding: 20px 24px;
  border-bottom: 1px solid var(--card-border);
}

.filter-row {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 12px;
  margin-bottom: 12px;
}

.filter-row select {
  padding: 8px 12px;
  background: var(--input-bg);
  border: 1px solid var(--input-border);
  border-radius: var(--r);
  color: var(--text);
  font-size: 12px;
  outline: none;
  appearance: none;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='10' height='10' fill='none' stroke='%2394A3B8' stroke-width='1.5'%3E%3Cpolyline points='2,3.5 5,6.5 8,3.5'/%3E%3C/svg%3E");
  background-repeat: no-repeat;
  background-position: right 8px center;
  padding-right: 28px;
  font-family: var(--font-body);
  transition: all var(--t);
}

.filter-row select:focus {
  border-color: var(--accent);
  box-shadow: 0 0 0 3px rgba(34,197,94,0.1);
}

.search-row {
  position: relative;
}

.search-row input {
  width: 100%;
  padding: 8px 12px 8px 36px;
  background: var(--input-bg);
  border: 1px solid var(--input-border);
  border-radius: var(--r);
  color: var(--text);
  font-size: 12px;
  outline: none;
  font-family: var(--font-body);
  transition: all var(--t);
}

.search-row input:focus {
  border-color: var(--accent);
  background: var(--input-bg-focus);
  box-shadow: 0 0 0 3px rgba(34,197,94,0.1);
}

.search-icon {
  position: absolute;
  left: 12px;
  top: 50%;
  transform: translateY(-50%);
  width: 16px;
  height: 16px;
  stroke: var(--text-muted);
  fill: none;
  stroke-width: 1.5;
  pointer-events: none;
}

.history-list {
  flex: 1;
  overflow-y: auto;
  padding: 0 24px;
}

.history-list::-webkit-scrollbar {
  width: 6px;
}

.history-list::-webkit-scrollbar-thumb {
  background: var(--card-border);
  border-radius: 6px;
}

.history-empty {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: 240px;
  color: var(--text-muted);
  text-align: center;
}

.history-empty svg {
  width: 64px;
  height: 64px;
  stroke: var(--text-muted);
  opacity: 0.5;
  margin-bottom: 20px;
}

.history-empty p {
  font-size: 16px;
  font-weight: 600;
  margin-bottom: 6px;
  font-family: var(--font-body);
}

.history-empty span {
  font-size: 13px;
  opacity: 0.8;
  font-family: var(--font-body);
}

.history-item {
  background: var(--card-bg);
  backdrop-filter: blur(12px);
  border: 1px solid var(--card-border);
  border-radius: var(--r);
  padding: 16px;
  margin-bottom: 12px;
  cursor: pointer;
  transition: all var(--t);
  position: relative;
}

.history-item:hover {
  background: rgba(30,41,59,0.8);
  border-color: rgba(34,197,94,0.3);
  transform: translateY(-2px);
  box-shadow: 0 8px 24px rgba(0,0,0,0.2);
}

.history-item.expanded {
  border-color: var(--accent);
}

.history-item-header {
  display: flex;
  align-items: center;
  gap: 12px;
  margin-bottom: 8px;
}

.module-badge {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 4px 8px;
  border-radius: 6px;
  font-size: 10px;
  font-weight: 700;
  text-transform: uppercase;
  font-family: var(--font-mono);
}

.module-badge.aes { background: var(--green-g); color: var(--accent); }
.module-badge.rsa { background: var(--green-g); color: var(--green); }
.module-badge.hash { background: var(--orange-g); color: var(--orange); }
.module-badge.base64 { background: rgba(0,255,255,0.12); color: var(--cyan); }
.module-badge.json { background: var(--yellow-g); color: var(--yellow); }
.module-badge.jwt { background: var(--pink-g); color: var(--pink); }
.module-badge.sm2 { background: var(--red-g); color: var(--red); }
.module-badge.sm4 { background: var(--red-g); color: var(--red); }

.module-icon {
  width: 6px;
  height: 6px;
  border-radius: 50%;
  background: currentColor;
}

.operation-desc {
  font-size: 13px;
  font-weight: 600;
  color: var(--text);
  flex: 1;
  font-family: var(--font-body);
}

.history-time {
  font-size: 10px;
  color: var(--text-muted);
  font-family: var(--font-mono);
}

.status-icon {
  margin-left: auto;
  width: 16px;
  height: 16px;
  stroke-width: 2;
}

.status-icon.success { color: var(--green); }
.status-icon.error { color: var(--red); }

.history-preview {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 12px;
  font-size: 11px;
  color: var(--text-muted);
  margin-top: 8px;
}

.preview-item {
  background: var(--input-bg);
  border-radius: 6px;
  padding: 6px 8px;
  font-family: var(--font-mono);
  word-break: break-all;
  line-height: 1.4;
}

.preview-label {
  color: var(--text-secondary);
  font-weight: 600;
  margin-bottom: 3px;
  font-family: var(--font-body);
  font-size: 10px;
  text-transform: uppercase;
  letter-spacing: 0.05em;
}

.history-item-details {
  display: none;
  margin-top: 16px;
  padding-top: 16px;
  border-top: 1px solid var(--input-border);
  animation: fadeUp 0.3s ease;
}

.history-item.expanded .history-item-details {
  display: block;
}

.detail-section {
  margin-bottom: 16px;
}

.detail-section:last-child {
  margin-bottom: 0;
}

.detail-label {
  font-size: 11px;
  font-weight: 700;
  color: var(--text-secondary);
  margin-bottom: 6px;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  font-family: var(--font-body);
}

.detail-content {
  background: var(--input-bg);
  border-radius: 8px;
  padding: 12px;
  font-family: var(--font-mono);
  font-size: 11px;
  line-height: 1.6;
  word-break: break-all;
  max-height: 140px;
  overflow-y: auto;
  color: var(--text-secondary);
}

.detail-content::-webkit-scrollbar {
  width: 4px;
}

.detail-content::-webkit-scrollbar-thumb {
  background: var(--card-border);
  border-radius: 4px;
}

.detail-actions {
  display: flex;
  gap: 8px;
  margin-top: 12px;
}

.detail-btn {
  padding: 6px 12px;
  border: 1px solid var(--input-border);
  background: var(--input-bg);
  color: var(--text-secondary);
  border-radius: 6px;
  font-size: 11px;
  font-weight: 600;
  cursor: pointer;
  transition: all var(--t);
  font-family: var(--font-body);
}

.detail-btn:hover {
  background: var(--green-g);
  border-color: var(--accent);
  color: var(--accent);
}

.detail-btn.danger {
  border-color: var(--red);
  color: var(--red);
}

.detail-btn.danger:hover {
  background: var(--red-g);
}

.history-stats {
  padding: 20px 24px;
  border-top: 1px solid var(--card-border);
  display: grid;
  grid-template-columns: 1fr 1fr 1fr;
  gap: 20px;
  background: rgba(255,255,255,0.02);
}

.stat-item {
  text-align: center;
}

.stat-label {
  display: block;
  font-size: 10px;
  color: var(--text-muted);
  margin-bottom: 4px;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  font-family: var(--font-body);
}

.stat-value {
  display: block;
  font-size: 18px;
  font-weight: 700;
  color: var(--accent);
  font-family: var(--font-display);
}

/* ═══ 动效和过渡 ═══ */
@keyframes fadeUp {
  from {
    opacity: 0;
    transform: translateY(8px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.anim {
  animation: fadeUp 0.25s ease-out;
}

/* 页面切换动效 */
[id^="page-"] {
  transition: opacity 0.25s ease-out, transform 0.25s ease-out;
}

[id^="page-"].page-entering {
  opacity: 0;
  transform: translateY(8px);
}

[id^="page-"].page-entering-active {
  opacity: 1;
  transform: translateY(0);
}

[id^="page-"].page-exiting {
  opacity: 1;
  transform: translateY(0);
}

[id^="page-"].page-exiting-active {
  opacity: 0;
  transform: translateY(-8px);
}

/* 输出区域flash效果 */
@keyframes output-flash {
  0% { 
    background-color: rgba(34,197,94,0.12); 
    border-color: rgba(34,197,94,0.3); 
  }
  50% { 
    background-color: rgba(34,197,94,0.08); 
    border-color: rgba(34,197,94,0.2); 
  }
  100% { 
    background-color: transparent; 
    border-color: var(--card-border); 
  }
}

.output-flash {
  animation: output-flash 0.8s ease-out;
  border: 1px solid var(--card-border);
  border-radius: var(--r);
}

/* 密钥生成动效 */
@keyframes key-generated {
  0% { 
    background-color: var(--input-bg); 
  }
  50% { 
    background-color: rgba(34,197,94,0.1); 
    border-color: var(--green); 
  }
  100% { 
    background-color: var(--input-bg); 
  }
}

.key-generated {
  animation: key-generated 0.6s ease-out;
}

/* 搜索高亮 */
.search-highlight {
  background: var(--yellow-g);
  color: var(--yellow);
  border-radius: 4px;
  padding: 0 3px;
  animation: highlight-pulse 1s ease-out;
}

@keyframes highlight-pulse {
  0% { background-color: transparent; }
  50% { background-color: var(--yellow-g); }
  100% { background-color: var(--yellow-g); }
}

/* ═══ 响应式设计 ═══ */
@media (prefers-reduced-motion: reduce) {
  * {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}

@media (max-width: 1440px) {
  .content {
    max-width: 1200px;
  }
}

@media (max-width: 1024px) {
  .sidebar {
    transform: translateX(-100%);
    transition: transform 0.3s ease;
  }
  
  .sidebar.show {
    transform: translateX(0);
  }
  
  .main {
    margin-left: 0;
    max-width: 100vw;
  }
  
  .io-g {
    grid-template-columns: 1fr;
  }
  
  .cat-grid {
    grid-template-columns: 1fr 1fr;
  }
  
  .history-panel {
    width: 100vw;
  }
  
  .stats {
    grid-template-columns: repeat(2, 1fr);
  }
}

@media (max-width: 768px) {
  .content {
    padding: 24px 16px;
  }
  
  .cat-grid {
    grid-template-columns: 1fr;
  }
  
  .page-h h2 {
    font-size: 24px;
  }
  
  .page-h p {
    margin-left: 0;
    margin-top: 8px;
  }
  
  .cfg {
    grid-template-columns: 1fr;
  }
  
  .hg {
    grid-template-columns: 1fr;
  }
}

@media (max-width: 375px) {
  .stats {
    grid-template-columns: 1fr;
  }
  
  .ab {
    flex-direction: column;
  }
}

/* 滚动条全局样式 */
::-webkit-scrollbar {
  width: 6px;
  height: 6px;
}

::-webkit-scrollbar-track {
  background: transparent;
}

::-webkit-scrollbar-thumb {
  background: rgba(148,163,184,0.2);
  border-radius: 6px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(148,163,184,0.3);
}

/* ═══ 密钥生成器专用样式 ═══ */
.kg {
  background: var(--card-bg);
  backdrop-filter: blur(12px);
  border: 1px solid var(--card-border);
  border-radius: var(--r);
  padding: 24px;
  margin-bottom: 20px;
}

.kg h3 {
  font-family: var(--font-display);
  font-size: 16px;
  font-weight: 600;
  margin-bottom: 16px;
  display: flex;
  align-items: center;
  gap: 12px;
}

.kg h3 .si {
  width: 32px;
  height: 32px;
  border-radius: 8px;
  display: flex;
  align-items: center;
  justify-content: center;
}

.kg h3 .si svg {
  width: 18px;
  height: 18px;
  stroke: currentColor;
  fill: none;
  stroke-width: 2;
  stroke-linecap: round;
  stroke-linejoin: round;
}

.chips {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  margin-bottom: 16px;
}

.chip {
  padding: 6px 14px;
  border-radius: 20px;
  font-size: 12px;
  font-weight: 600;
  background: var(--input-bg);
  border: 1px solid var(--input-border);
  color: var(--text-secondary);
  cursor: pointer;
  transition: all var(--t);
  font-family: var(--font-body);
}

.chip:hover {
  border-color: var(--accent);
  color: var(--accent);
  transform: translateY(-1px);
}

.chip.active {
  background: var(--green-g);
  border-color: var(--accent);
  color: var(--accent);
}

.obox {
  background: var(--input-bg);
  border: 1px solid var(--input-border);
  border-radius: var(--r);
  padding: 16px;
  font-family: var(--font-mono);
  font-size: 12px;
  line-height: 1.6;
  min-height: 80px;
  position: relative;
  word-break: break-all;
  color: var(--text-secondary);
}

.obox .cp {
  position: absolute;
  top: 8px;
  right: 8px;
  padding: 4px 12px;
  border-radius: 6px;
  border: 1px solid var(--input-border);
  background: var(--input-bg);
  color: var(--text-muted);
  font-size: 11px;
  cursor: pointer;
  font-family: var(--font-body);
  font-weight: 500;
  transition: all var(--t);
}

.obox .cp:hover {
  color: var(--text);
  border-color: var(--accent);
}

.opair {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 16px;
}

/* ═══ JSON工具专用样式 ═══ */
#json-out {
  color: var(--green-light);
  white-space: pre-wrap;
  overflow: auto;
  user-select: all;
}

#json-status {
  color: var(--green);
}

.json-tree-node {
  transition: max-height 0.25s ease, opacity 0.25s ease;
}

/* 确保所有动态内容使用正确字体 */
.out,
.hv,
.detail-content,
#hash-char-count {
  font-family: var(--font-mono);
}

.nav-i,
.pill,
.btn,
.f label,
input,
select,
.toast .toast-text {
  font-family: var(--font-body);
}

h1,
h2,
h3,
.sb-logo h1,
.page-h h2,
.cat-card h3,
.kg h3,
.history-title,
.stat .n {
  font-family: var(--font-display);
}
  user-select: all;
}

#json-status {
  color: var(--green);
}

.json-tree-node {
  transition: max-height 0.25s ease, opacity 0.25s ease;
}

/* 确保所有动态内容使用正确字体 */
.out,
.hv,
.detail-content,
#hash-char-count {
  font-family: var(--font-mono);
}

.nav-i,
.pill,
.btn,
.f label,
input,
select,
.toast .toast-text {
  font-family: var(--font-body);
}

h1,
h2,
h3,
.sb-logo h1,
.page-h h2,
.cat-card h3,
.kg h3,
.history-title,
.stat .n {
  font-family: var(--font-display);
}
</style>
</head>

<body>
<!-- Toast 通知容器 -->
<div class="toast-container" id="toast-container"></div>

<div class="app">
<aside class="sidebar">
  <div class="sb-header">
    <div class="sb-logo">
      <div class="mark">
        <svg viewBox="0 0 256 256" style="fill:none;stroke:none">
          <defs>
            <linearGradient id="lg" x1="0%" y1="0%" x2="100%" y2="100%">
              <stop offset="0%" style="stop-color:#FDE68A"/>
              <stop offset="100%" style="stop-color:#D97706"/>
            </linearGradient>
            <linearGradient id="lc" x1="0%" y1="0%" x2="0%" y2="100%">
              <stop offset="0%" style="stop-color:#22D3EE"/>
              <stop offset="100%" style="stop-color:#06B6D4"/>
            </linearGradient>
          </defs>
          <path d="M128 28L212 64Q220 68 220 78L220 148Q220 200 128 238Q36 200 36 148L36 78Q36 68 44 64Z" fill="rgba(6,182,212,0.12)" stroke="url(#lc)" stroke-width="5"/>
          <g transform="translate(128,128)">
            <path d="M-28,-38L-28,-58Q-28,-84 0,-84Q28,-84 28,-58L28,-38" fill="none" stroke="url(#lg)" stroke-width="10" stroke-linecap="round"/>
            <rect x="-40" y="-42" width="80" height="64" rx="10" fill="url(#lg)"/>
            <circle cx="0" cy="-20" r="9" fill="#0a0a0f"/>
            <path d="M-5,-13L-7,4L7,4L5,-13" fill="#0a0a0f"/>
          </g>
        </svg>
      </div>
      <div>
        <h1>CryptoBox</h1>
        <div class="ver">v1.0 · 全能加解密工具箱</div>
      </div>
    </div>
  </div>
  
  <div class="sb-search">
    <input type="text" placeholder="搜索算法..." id="searchInput"/>
  </div>
  
  <nav class="sb-nav">
    <div class="nav-g">
      <div class="nav-i active" data-page="home">
        <span class="ni c-accent">
          <svg viewBox="0 0 24 24">
            <rect x="3" y="3" width="7" height="7" rx="1"/>
            <rect x="14" y="3" width="7" height="7" rx="1"/>
            <rect x="3" y="14" width="7" height="7" rx="1"/>
            <rect x="14" y="14" width="7" height="7" rx="1"/>
          </svg>
        </span>
        <span>工作台</span>
      </div>
    </div>
    
    <div class="nav-g">
      <div class="nav-gl">对称加密</div>
      <div class="nav-i" data-page="aes">
        <span class="ni c-accent">
          <svg viewBox="0 0 24 24">
            <rect x="3" y="11" width="18" height="11" rx="2"/>
            <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
          </svg>
        </span>
        <span>AES</span>
        <span class="badge">4 modes</span>
      </div>
      <div class="nav-i" data-page="des">
        <span class="ni c-cyan">
          <svg viewBox="0 0 24 24">
            <rect x="3" y="11" width="18" height="11" rx="2"/>
            <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
            <line x1="12" y1="15" x2="12" y2="18"/>
          </svg>
        </span>
        <span>DES / 3DES</span>
      </div>
      <div class="nav-i" data-page="chacha20">
        <span class="ni c-lime">
          <svg viewBox="0 0 24 24">
            <path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z"/>
          </svg>
        </span>
        <span>ChaCha20</span>
      </div>
      <div class="nav-i" data-page="blowfish">
        <span class="ni c-orange">
          <svg viewBox="0 0 24 24">
            <circle cx="12" cy="12" r="3"/>
            <path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/>
          </svg>
        </span>
        <span>Blowfish</span>
      </div>
      <div class="nav-i" data-page="rc4">
        <span class="ni c-yellow">
          <svg viewBox="0 0 24 24">
            <polyline points="16 3 21 3 21 8"/>
            <line x1="4" y1="20" x2="21" y2="3"/>
            <polyline points="21 16 21 21 16 21"/>
            <line x1="15" y1="15" x2="21" y2="21"/>
            <line x1="4" y1="4" x2="9" y2="9"/>
          </svg>
        </span>
        <span>RC4</span>
      </div>
      <div class="nav-i" data-page="sm4">
        <span class="ni c-red">
          <svg viewBox="0 0 24 24">
            <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>
          </svg>
        </span>
        <span>SM4</span>
        <span class="badge gm">国密</span>
      </div>
    </div>
    
    <div class="nav-g">
      <div class="nav-gl">非对称加密</div>
      <div class="nav-i" data-page="rsa">
        <span class="ni c-green">
          <svg viewBox="0 0 24 24">
            <path d="M21 2l-2 2m-7.61 7.61a5.5 5.5 0 1 1-7.778 7.778 5.5 5.5 0 0 1 7.777-7.777zm0 0L15.5 7.5m0 0l3 3L22 7l-3-3m-3.5 3.5L19 4"/>
          </svg>
        </span>
        <span>RSA</span>
      </div>
      <div class="nav-i" data-page="ecc">
        <span class="ni c-cyan">
          <svg viewBox="0 0 24 24">
            <ellipse cx="12" cy="12" rx="10" ry="6"/>
            <line x1="12" y1="6" x2="12" y2="18"/>
          </svg>
        </span>
        <span>ECC / ECDSA</span>
      </div>
      <div class="nav-i" data-page="ed25519">
        <span class="ni c-pink">
          <svg viewBox="0 0 24 24">
            <path d="M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4"/>
            <polyline points="10 17 15 12 10 7"/>
            <line x1="15" y1="12" x2="3" y2="12"/>
          </svg>
        </span>
        <span>Ed25519</span>
      </div>
      <div class="nav-i" data-page="sm2">
        <span class="ni c-red">
          <svg viewBox="0 0 24 24">
            <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>
            <path d="M9 12l2 2 4-4"/>
          </svg>
        </span>
        <span>SM2</span>
        <span class="badge gm">国密</span>
      </div>
    </div>
    
    <div class="nav-g">
      <div class="nav-gl">哈希 & HMAC</div>
      <div class="nav-i" data-page="hash">
        <span class="ni c-orange">
          <svg viewBox="0 0 24 24">
            <line x1="4" y1="9" x2="20" y2="9"/>
            <line x1="4" y1="15" x2="20" y2="15"/>
            <line x1="10" y1="3" x2="8" y2="21"/>
            <line x1="16" y1="3" x2="14" y2="21"/>
          </svg>
        </span>
        <span>Hash 通用</span>
        <span class="badge">12+</span>
      </div>
      <div class="nav-i" data-page="hmac">
        <span class="ni c-yellow">
          <svg viewBox="0 0 24 24">
            <path d="M12 20h9"/>
            <path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"/>
          </svg>
        </span>
        <span>HMAC</span>
      </div>
      <div class="nav-i" data-page="password">
        <span class="ni c-pink">
          <svg viewBox="0 0 24 24">
            <path d="M2 18v3c0 .6.4 1 1 1h4v-3h3v-3h2l1.4-1.4a6.5 6.5 0 1 0-4-4z"/>
            <circle cx="16.5" cy="7.5" r=".5" fill="currentColor"/>
          </svg>
        </span>
        <span>密码哈希</span>
        <span class="badge">4</span>
      </div>
    </div>
    
    <div class="nav-g">
      <div class="nav-gl">编码 & 序列化</div>
      <div class="nav-i" data-page="base64">
        <span class="ni c-cyan">
          <svg viewBox="0 0 24 24">
            <path d="M16 18l6-6-6-6"/>
            <path d="M8 6l-6 6 6 6"/>
          </svg>
        </span>
        <span>Base64 / Base32</span>
      </div>
      <div class="nav-i" data-page="hex">
        <span class="ni c-lime">
          <svg viewBox="0 0 24 24">
            <polyline points="4 7 4 4 20 4 20 7"/>
            <line x1="9" y1="20" x2="15" y2="20"/>
            <line x1="12" y1="4" x2="12" y2="20"/>
          </svg>
        </span>
        <span>Hex / URL</span>
      </div>
      <div class="nav-i" data-page="jwt">
        <span class="ni c-orange">
          <svg viewBox="0 0 24 24">
            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
            <polyline points="14 2 14 8 20 8"/>
            <line x1="16" y1="13" x2="8" y2="13"/>
            <line x1="16" y1="17" x2="8" y2="17"/>
          </svg>
        </span>
        <span>JWT</span>
      </div>
      <div class="nav-i" data-page="json">
        <span class="ni c-yellow">
          <svg viewBox="0 0 24 24">
            <path d="M8 3H7a2 2 0 0 0-2 2v5a2 2 0 0 1-2 2 2 2 0 0 1 2 2v5a2 2 0 0 0 2 2h1"/>
            <path d="M16 3h1a2 2 0 0 1 2 2v5a2 2 0 0 0 2 2 2 2 0 0 0-2 2v5a2 2 0 0 1-2 2h-1"/>
          </svg>
        </span>
        <span>JSON 工具</span>
        <span class="badge">8+</span>
      </div>
    </div>
    
    <div class="nav-g">
      <div class="nav-gl">工具</div>
      <div class="nav-i" data-page="keygen">
        <span class="ni c-pink">
          <svg viewBox="0 0 24 24">
            <circle cx="12" cy="12" r="3"/>
            <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"/>
          </svg>
        </span>
        <span>密钥生成器</span>
      </div>
      <div class="nav-i" data-page="cert">
        <span class="ni c-green">
          <svg viewBox="0 0 24 24">
            <rect x="2" y="7" width="20" height="14" rx="2" ry="2"/>
            <path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"/>
          </svg>
        </span>
        <span>证书工具</span>
      </div>
      <div class="nav-i" data-page="compare">
        <span class="ni c-yellow">
          <svg viewBox="0 0 24 24">
            <circle cx="11" cy="11" r="8"/>
            <line x1="21" y1="21" x2="16.65" y2="16.65"/>
          </svg>
        </span>
        <span>对比工具</span>
      </div>
    </div>
  </nav>
</aside>

<main class="main">
  <header class="topbar">
    <div class="bc">
      <span>CryptoBox</span>
      <span class="sep">/</span>
      <span class="cur" id="bcCur">工作台</span>
    </div>
    <div class="tb-r">
      <button class="tb-btn" id="history-toggle">
        <svg viewBox="0 0 24 24">
          <path d="M1 4v6h6"/>
          <path d="M3.51 15a9 9 0 1 0 2.13-9.36L1 10"/>
        </svg>
        历史
        <span id="history-badge" class="badge-count" style="display:none">0</span>
      </button>
      <button class="tb-btn" id="theme-toggle">
        <svg viewBox="0 0 24 24">
          <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
        </svg>
        <span id="theme-text">暗色</span>
      </button>
      <button class="tb-btn" id="debug-test-btn" onclick="runAllTests()" style="display:none">
        <svg viewBox="0 0 24 24">
          <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
          <polyline points="22 4 12 14.01 9 11.01"/>
        </svg>
        测试
      </button>
    </div>
  </header>

  <!-- 首页 -->
  <div class="content anim" id="page-home">
    <div class="page-h">
      <h2>
        <span class="hi" style="background:rgba(34,197,94,0.12);color:#22C55E">
          <svg viewBox="0 0 256 256" style="fill:none;stroke:none">
            <defs>
              <linearGradient id="hg" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" style="stop-color:#FDE68A"/>
                <stop offset="100%" style="stop-color:#D97706"/>
              </linearGradient>
              <linearGradient id="hc" x1="0%" y1="0%" x2="0%" y2="100%">
                <stop offset="0%" style="stop-color:#22D3EE"/>
                <stop offset="100%" style="stop-color:#06B6D4"/>
              </linearGradient>
            </defs>
            <path d="M128 28L212 64Q220 68 220 78L220 148Q220 200 128 238Q36 200 36 148L36 78Q36 68 44 64Z" fill="rgba(6,182,212,0.15)" stroke="url(#hc)" stroke-width="5"/>
            <g transform="translate(128,128)">
              <path d="M-28,-38L-28,-58Q-28,-84 0,-84Q28,-84 28,-58L28,-38" fill="none" stroke="url(#hg)" stroke-width="10" stroke-linecap="round"/>
              <rect x="-40" y="-42" width="80" height="64" rx="10" fill="url(#hg)"/>
              <circle cx="0" cy="-20" r="9" fill="#0a0a0f"/>
              <path d="M-5,-13L-7,4L7,4L5,-13" fill="#0a0a0f"/>
            </g>
          </svg>
        </span>
        CryptoBox 工作台
      </h2>
      <p>选择一个加密类别开始工作，支持 30+ 种主流和非主流加解密算法</p>
    </div>
    
    <div class="cat-grid">
      <div class="cat-card" data-goto="aes">
        <div class="cat-icon c-accent">
          <svg viewBox="0 0 24 24">
            <rect x="3" y="11" width="18" height="11" rx="2"/>
            <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
          </svg>
        </div>
        <h3>对称加密</h3>
        <p>AES、DES、3DES、ChaCha20、Blowfish、RC4、SM4</p>
        <div class="tags">
          <span class="tag">AES-256-GCM</span>
          <span class="tag">AES-CBC</span>
          <span class="tag">ChaCha20</span>
          <span class="tag">SM4</span>
        </div>
      </div>
      
      <div class="cat-card" data-goto="rsa">
        <div class="cat-icon c-green">
          <svg viewBox="0 0 24 24">
            <path d="M21 2l-2 2m-7.61 7.61a5.5 5.5 0 1 1-7.778 7.778 5.5 5.5 0 0 1 7.777-7.777zm0 0L15.5 7.5m0 0l3 3L22 7l-3-3m-3.5 3.5L19 4"/>
          </svg>
        </div>
        <h3>非对称加密</h3>
        <p>RSA 加解密/签名、ECC/ECDSA、Ed25519、SM2 国密</p>
        <div class="tags">
          <span class="tag">RSA-2048</span>
          <span class="tag">P-256</span>
          <span class="tag">Ed25519</span>
          <span class="tag">SM2</span>
        </div>
      </div>
      
      <div class="cat-card" data-goto="hash">
        <div class="cat-icon c-orange">
          <svg viewBox="0 0 24 24">
            <line x1="4" y1="9" x2="20" y2="9"/>
            <line x1="4" y1="15" x2="20" y2="15"/>
            <line x1="10" y1="3" x2="8" y2="21"/>
            <line x1="16" y1="3" x2="14" y2="21"/>
          </svg>
        </div>
        <h3>哈希 & HMAC</h3>
        <p>MD5、SHA 全系列、SHA-3、SM3、BLAKE2/3、RIPEMD-160</p>
        <div class="tags">
          <span class="tag">SHA-256</span>
          <span class="tag">SHA-3</span>
          <span class="tag">SM3</span>
          <span class="tag">BLAKE3</span>
        </div>
      </div>
      
      <div class="cat-card" data-goto="base64">
        <div class="cat-icon c-cyan">
          <svg viewBox="0 0 24 24">
            <path d="M16 18l6-6-6-6"/>
            <path d="M8 6l-6 6 6 6"/>
          </svg>
        </div>
        <h3>编码 & 序列化</h3>
        <p>Base64、Base32、Hex、URL Encode、Unicode 编解码</p>
        <div class="tags">
          <span class="tag">Base64</span>
          <span class="tag">Hex</span>
          <span class="tag">URL</span>
          <span class="tag">Unicode</span>
        </div>
      </div>
      
      <div class="cat-card" data-goto="json">
        <div class="cat-icon c-yellow">
          <svg viewBox="0 0 24 24">
            <path d="M8 3H7a2 2 0 0 0-2 2v5a2 2 0 0 1-2 2 2 2 0 0 1 2 2v5a2 2 0 0 0 2 2h1"/>
            <path d="M16 3h1a2 2 0 0 1 2 2v5a2 2 0 0 0 2 2 2 2 0 0 0-2 2v5a2 2 0 0 1-2 2h-1"/>
          </svg>
        </div>
        <h3>JSON 工具</h3>
        <p>JSON 格式化、压缩、校验、转换、树形视图</p>
        <div class="tags">
          <span class="tag">格式化</span>
          <span class="tag">压缩</span>
          <span class="tag">转代码</span>
          <span class="tag">Diff</span>
        </div>
      </div>
      
      <div class="cat-card" data-goto="keygen">
        <div class="cat-icon c-pink">
          <svg viewBox="0 0 24 24">
            <circle cx="12" cy="12" r="3"/>
            <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4"/>
          </svg>
        </div>
        <h3>密钥生成器</h3>
        <p>一键生成 RSA/ECC/AES 密钥、随机字节、安全密码</p>
        <div class="tags">
          <span class="tag">RSA-4096</span>
          <span class="tag">AES-Key</span>
          <span class="tag">Random</span>
          <span class="tag">Password</span>
        </div>
      </div>
      
      <div class="cat-card" data-goto="jwt">
        <div class="cat-icon c-blue">
          <svg viewBox="0 0 24 24">
            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
            <polyline points="14 2 14 8 20 8"/>
            <line x1="16" y1="13" x2="8" y2="13"/>
            <line x1="16" y1="17" x2="8" y2="17"/>
          </svg>
        </div>
        <h3>JWT & 证书</h3>
        <p>JWT 编解码与验签、X.509 证书解析、PEM/DER 转换</p>
        <div class="tags">
          <span class="tag">JWT</span>
          <span class="tag">X.509</span>
          <span class="tag">PEM</span>
          <span class="tag">DER</span>
        </div>
      </div>
    </div>
    
    <div class="stats" id="home-stats">
      <div class="stat">
        <div class="n" id="stats-algorithms">30+</div>
        <div class="l">加密算法</div>
      </div>
      <div class="stat">
        <div class="n" id="stats-pages">15</div>
        <div class="l">功能页面</div>
      </div>
      <div class="stat">
        <div class="n" id="stats-tests">27</div>
        <div class="l">单元测试</div>
      </div>
      <div class="stat">
        <div class="n">100%</div>
        <div class="l">本地运算</div>
      </div>
    </div>
  </div>

  <!-- AES 页面 -->
  <div class="content anim" id="page-aes" style="display:none">
    <div class="page-h">
      <h2>
        <span class="hi" style="background:var(--green-g);color:var(--accent)">
          <svg viewBox="0 0 24 24">
            <rect x="3" y="11" width="18" height="11" rx="2"/>
            <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
          </svg>
        </span>
        AES 加解密
      </h2>
      <p>Advanced Encryption Standard — 支持 ECB / CBC / CTR / GCM 四种模式</p>
    </div>
    
    <div class="ws">
      <div class="pills">
        <button class="pill active">AES-128-CBC</button>
        <button class="pill">AES-256-CBC</button>
        <button class="pill">AES-128-ECB</button>
        <button class="pill">AES-256-ECB</button>
        <button class="pill">AES-128-CTR</button>
        <button class="pill">AES-256-CTR</button>
        <button class="pill">AES-128-GCM</button>
        <button class="pill">AES-256-GCM</button>
      </div>
      
      <div class="cfg">
        <div class="f">
          <label>密钥长度</label>
          <select>
            <option>128 bit</option>
            <option selected>256 bit</option>
          </select>
        </div>
        <div class="f">
          <label>模式</label>
          <select>
            <option selected>CBC</option>
            <option>ECB</option>
            <option>CTR</option>
            <option>GCM</option>
          </select>
        </div>
        <div class="f">
          <label>填充</label>
          <select>
            <option selected>PKCS7</option>
            <option>ZeroPadding</option>
            <option>NoPadding</option>
          </select>
        </div>
        <div class="f">
          <label>输出格式</label>
          <select>
            <option selected>Base64</option>
            <option>Hex</option>
          </select>
        </div>
        <div class="f">
          <label>Key</label>
          <input type="text" placeholder="输入密钥或点击生成"/>
        </div>
        <div class="f">
          <label>IV</label>
          <input type="text" placeholder="16 bytes"/>
        </div>
      </div>
      
      <div class="qa">
        <button>
          <svg viewBox="0 0 24 24">
            <path d="M23 4v6h-6"/>
            <path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"/>
          </svg>
          随机 Key
        </button>
        <button>
          <svg viewBox="0 0 24 24">
            <path d="M23 4v6h-6"/>
            <path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"/>
          </svg>
          随机 IV
        </button>
      </div>
      
      <div class="io-g">
        <div class="io">
          <div class="io-h">
            <div class="lb">
              <span class="dot" style="background:var(--accent)"></span>
              输入 (明文)
            </div>
            <div class="acts">
              <button>粘贴</button>
              <button>文件</button>
              <button>清空</button>
            </div>
          </div>
          <textarea placeholder="在此输入要加密的内容..."></textarea>
          <div class="ftabs">
            <div class="ftab active">UTF-8</div>
            <div class="ftab">Hex</div>
            <div class="ftab">Base64</div>
          </div>
        </div>
        
        <div class="io">
          <div class="io-h">
            <div class="lb">
              <span class="dot" style="background:var(--green)"></span>
              输出 (密文)
            </div>
            <div class="acts">
              <button>复制</button>
              <button>保存</button>
            </div>
          </div>
          <div class="out">点击加密按钮执行操作，结果将显示在这里</div>
          <div class="ft">
            长度: <span>0</span> · 编码: <span>Base64</span> · 耗时: <span>0ms</span>
          </div>
        </div>
      </div>
      
      <div class="ab">
        <button class="btn btn-p">
          <svg viewBox="0 0 24 24">
            <rect x="3" y="11" width="18" height="11" rx="2"/>
            <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
          </svg>
          加密 Encrypt
        </button>
        <button class="btn-sw">
          <svg viewBox="0 0 24 24">
            <path d="M7 16V4m0 0L3 8m4-4l4 4M17 8v12m0 0l4-4m-4 4l-4-4"/>
          </svg>
        </button>
        <button class="btn btn-g">
          <svg viewBox="0 0 24 24">
            <rect x="3" y="11" width="18" height="11" rx="2"/>
            <path d="M7 11V7a5 5 0 0 1 5-5 5 5 0 0 1 5 5"/>
          </svg>
          解密 Decrypt
        </button>
      </div>
    </div>
  </div>

  <!-- Hash 页面 -->
  <div class="content anim" id="page-hash" style="display:none">
    <div class="page-h">
      <h2>
        <span class="hi" style="background:var(--orange-g);color:var(--orange)">
          <svg viewBox="0 0 24 24">
            <line x1="4" y1="9" x2="20" y2="9"/>
            <line x1="4" y1="15" x2="20" y2="15"/>
            <line x1="10" y1="3" x2="8" y2="21"/>
            <line x1="16" y1="3" x2="14" y2="21"/>
          </svg>
        </span>
        哈希计算
      </h2>
      <p>一次输入，同时计算所有哈希值 — 支持 12+ 种哈希算法，支持文件拖拽</p>
    </div>
    
    <div class="ws">
      <div class="io" id="hash-drop-zone">
        <div class="io-h">
          <div class="lb">
            <span class="dot" style="background:var(--orange)"></span>
            输入
          </div>
          <div class="acts">
            <button id="hash-paste">粘贴</button>
            <button id="hash-file">文件哈希</button>
            <button id="hash-clear">清空</button>
          </div>
        </div>
        <textarea id="hash-input" style="min-height:120px" placeholder="输入文本或拖拽文件到此处..."></textarea>
        <div class="ftabs">
          <div class="ftab active">UTF-8</div>
          <div class="ftab">Hex</div>
          <div class="ftab">Base64</div>
          <div class="ftab">文件</div>
        </div>
      </div>
      
      <div class="hg" id="hash-results">
        <div class="hi2">
          <div class="hl">
            <span>MD5</span>
            <button data-hash="md5">复制</button>
          </div>
          <div class="hv" id="hash-md5">点击计算哈希显示结果</div>
        </div>
        
        <div class="hi2">
          <div class="hl">
            <span>SHA-1</span>
            <button data-hash="sha1">复制</button>
          </div>
          <div class="hv" id="hash-sha1">点击计算哈希显示结果</div>
        </div>
        
        <div class="hi2">
          <div class="hl">
            <span>SHA-256</span>
            <button data-hash="sha256">复制</button>
          </div>
          <div class="hv" id="hash-sha256">点击计算哈希显示结果</div>
        </div>
        
        <div class="hi2">
          <div class="hl">
            <span>SHA-512</span>
            <button data-hash="sha512">复制</button>
          </div>
          <div class="hv" id="hash-sha512">点击计算哈希显示结果</div>
        </div>
        
        <div class="hi2">
          <div class="hl">
            <span>SHA-3 (256)</span>
            <button data-hash="sha3">复制</button>
          </div>
          <div class="hv" id="hash-sha3">点击计算哈希显示结果</div>
        </div>
        
        <div class="hi2">
          <div class="hl">
            <span>SM3 <span class="gm">国密</span></span>
            <button data-hash="sm3">复制</button>
          </div>
          <div class="hv" id="hash-sm3">点击计算哈希显示结果</div>
        </div>
        
        <div class="hi2">
          <div class="hl">
            <span>BLAKE2b</span>
            <button data-hash="blake2b">复制</button>
          </div>
          <div class="hv" id="hash-blake2b">点击计算哈希显示结果</div>
        </div>
        
        <div class="hi2">
          <div class="hl">
            <span>BLAKE3</span>
            <button data-hash="blake3">复制</button>
          </div>
          <div class="hv" id="hash-blake3">点击计算哈希显示结果</div>
        </div>
      </div>
      
      <div class="ab">
        <button class="btn btn-p" id="hash-compute">
          <svg viewBox="0 0 24 24">
            <line x1="4" y1="9" x2="20" y2="9"/>
            <line x1="4" y1="15" x2="20" y2="15"/>
            <line x1="10" y1="3" x2="8" y2="21"/>
            <line x1="16" y1="3" x2="14" y2="21"/>
          </svg>
          计算哈希
        </button>
        <button class="btn btn-o" id="hash-copy-all">全部复制</button>
        <button class="btn btn-o" onclick="window.open('data:text/plain,'+encodeURIComponent(document.getElementById('hash-input').value),'_blank')">导出文本</button>
      </div>
    </div>
  </div>

  <!-- 密钥生成器页面 -->
  <div class="content anim" id="page-keygen" style="display:none">
    <div class="page-h">
      <h2>
        <span class="hi" style="background:var(--pink-g);color:var(--pink)">
          <svg viewBox="0 0 24 24">
            <circle cx="12" cy="12" r="3"/>
            <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4"/>
          </svg>
        </span>
        密钥生成器
      </h2>
      <p>一键生成各类加密密钥，支持多种格式导出</p>
    </div>
    
    <div class="ws">
      <div class="kg">
        <h3>
          <span class="si" style="background:var(--green-g);color:var(--accent)">
            <svg viewBox="0 0 24 24">
              <rect x="3" y="11" width="18" height="11" rx="2"/>
              <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
            </svg>
          </span>
          对称密钥
        </h3>
        <div class="chips">
          <span class="chip active">AES-128</span>
          <span class="chip">AES-192</span>
          <span class="chip">AES-256</span>
          <span class="chip">ChaCha20</span>
          <span class="chip">SM4</span>
        </div>
        <div class="cfg" style="margin-bottom:16px; grid-template-columns: 1fr 1fr;">
          <div class="f">
            <label>格式</label>
            <select><option>Hex</option><option>Base64</option></select>
          </div>
          <div class="f">
            <label>数量</label>
            <input type="number" value="1" min="1" max="10"/>
          </div>
        </div>
        <button class="btn btn-p" style="font-size:13px;padding:8px 16px;margin-bottom:12px">
          <svg viewBox="0 0 24 24">
            <path d="M23 4v6h-6"/>
            <path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"/>
          </svg>
          生成密钥
        </button>
        <div class="obox" style="color:var(--green-light)">
          <button class="cp">复制</button>
          点击生成按钮获取密钥
        </div>
      </div>
      
      <div class="kg">
        <h3>
          <span class="si" style="background:var(--green-g);color:var(--green)">
            <svg viewBox="0 0 24 24">
              <path d="M21 2l-2 2m-7.61 7.61a5.5 5.5 0 1 1-7.778 7.778 5.5 5.5 0 0 1 7.777-7.777zm0 0L15.5 7.5m0 0l3 3L22 7l-3-3m-3.5 3.5L19 4"/>
            </svg>
          </span>
          RSA 密钥对
        </h3>
        <div class="chips">
          <span class="chip">1024</span>
          <span class="chip active">2048</span>
          <span class="chip">3072</span>
          <span class="chip">4096</span>
        </div>
        <div class="cfg" style="margin-bottom:16px; max-width:240px;">
          <div class="f">
            <label>格式</label>
            <select>
              <option>PEM (PKCS#8)</option>
              <option>PEM (PKCS#1)</option>
              <option>DER</option>
              <option>JWK</option>
            </select>
          </div>
        </div>
        <button class="btn btn-g" style="font-size:13px;padding:8px 16px;margin-bottom:12px">
          <svg viewBox="0 0 24 24">
            <path d="M23 4v6h-6"/>
            <path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"/>
          </svg>
          生成密钥对
        </button>
        <div class="opair">
          <div class="obox" style="color:var(--green);font-size:11px;min-height:120px">
            <button class="cp">复制</button>
            点击生成按钮获取公钥
          </div>
          <div class="obox" style="color:var(--red);font-size:11px;min-height:120px">
            <button class="cp">复制</button>
            点击生成按钮获取私钥
          </div>
        </div>
      </div>
      
      <div class="kg">
        <h3>
          <span class="si" style="background:rgba(0,255,255,0.12);color:var(--cyan)">
            <svg viewBox="0 0 24 24">
              <ellipse cx="12" cy="12" rx="10" ry="6"/>
              <line x1="12" y1="6" x2="12" y2="18"/>
            </svg>
          </span>
          ECC 密钥对
        </h3>
        <div class="chips">
          <span class="chip active">P-256</span>
          <span class="chip">P-384</span>
          <span class="chip">P-521</span>
          <span class="chip">secp256k1</span>
          <span class="chip">Ed25519</span>
          <span class="chip">X25519</span>
        </div>
        <button class="btn" style="background:linear-gradient(135deg,var(--cyan),#0891b2);color:#fff;box-shadow:0 4px 16px rgba(6,182,212,0.3);font-size:13px;padding:8px 16px;margin:12px 0">
          <svg viewBox="0 0 24 24">
            <path d="M23 4v6h-6"/>
            <path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"/>
          </svg>
          生成密钥对
        </button>
        <div class="obox" style="color:var(--cyan)">
          <button class="cp">复制</button>
          点击生成按钮获取密钥对
        </div>
      </div>
      
      <div class="kg">
        <h3>
          <span class="si" style="background:var(--yellow-g);color:var(--yellow)">
            <svg viewBox="0 0 24 24">
              <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/>
            </svg>
          </span>
          随机数 & 密码
        </h3>
        <div class="cfg" style="margin-bottom:16px;">
          <div class="f">
            <label>类型</label>
            <select>
              <option>随机字节</option>
              <option>安全密码</option>
              <option>UUID v4</option>
            </select>
          </div>
          <div class="f">
            <label>长度</label>
            <input type="number" value="32" min="1" max="256"/>
          </div>
          <div class="f">
            <label>格式</label>
            <select>
              <option>Hex</option>
              <option>Base64</option>
              <option>Base58</option>
            </select>
          </div>
        </div>
        <button class="btn" style="background:linear-gradient(135deg,var(--yellow),#ca8a04);color:#fff;box-shadow:0 4px 16px rgba(234,179,8,0.3);font-size:13px;padding:8px 16px;margin-bottom:12px">
          <svg viewBox="0 0 24 24">
            <path d="M23 4v6h-6"/>
            <path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"/>
          </svg>
          生成
        </button>
        <div class="obox" style="color:var(--yellow)">
          <button class="cp">复制</button>
          点击生成按钮获取随机数据
        </div>
      </div>
    </div>
  </div>

  <!-- JSON 工具页面 -->
  <div class="content anim" id="page-json" style="display:none">
    <div class="page-h">
      <h2>
        <span class="hi" style="background:var(--yellow-g);color:var(--yellow)">
          <svg viewBox="0 0 24 24">
            <path d="M8 3H7a2 2 0 0 0-2 2v5a2 2 0 0 1-2 2 2 2 0 0 1 2 2v5a2 2 0 0 0 2 2h1"/>
            <path d="M16 3h1a2 2 0 0 1 2 2v5a2 2 0 0 0 2 2 2 2 0 0 0-2 2v5a2 2 0 0 1-2 2h-1"/>
          </svg>
        </span>
        JSON 工具
      </h2>
      <p>JSON 格式化、校验、压缩、转换、树形视图 — 参考 BeJSON</p>
    </div>
    
    <div class="ws">
      <div class="pills">
        <button class="pill active" data-jtab="format">格式化/美化</button>
        <button class="pill" data-jtab="compress">压缩</button>
        <button class="pill" data-jtab="escape">转义/去转义</button>
        <button class="pill" data-jtab="tree">树形视图</button>
        <button class="pill" data-jtab="convert">格式转换</button>
        <button class="pill" data-jtab="codegen">转代码</button>
        <button class="pill" data-jtab="diff">JSON Diff</button>
        <button class="pill" data-jtab="path">JSONPath</button>
      </div>
      
      <div class="cfg" id="json-cfg-format">
        <div class="f">
          <label>缩进</label>
          <select id="json-indent">
            <option value="2" selected>2 空格</option>
            <option value="4">4 空格</option>
            <option value="t">Tab</option>
            <option value="1">1 空格</option>
          </select>
        </div>
        <div class="f">
          <label>排序 Key</label>
          <select id="json-sort">
            <option value="0">不排序</option>
            <option value="1">A → Z</option>
            <option value="2">Z → A</option>
          </select>
        </div>
        <div class="f">
          <label>Unicode</label>
          <select id="json-unicode">
            <option value="0">保持原样</option>
            <option value="1">转中文</option>
            <option value="2">转 Unicode</option>
          </select>
        </div>
      </div>
      
      <div class="cfg" id="json-cfg-convert" style="display:none">
        <div class="f">
          <label>目标格式</label>
          <select id="json-convert-target">
            <option>XML</option>
            <option>YAML</option>
            <option>CSV</option>
            <option>TOML</option>
            <option>URL Params</option>
            <option>PHP Array</option>
            <option>SQL INSERT</option>
          </select>
        </div>
      </div>
      
      <div class="cfg" id="json-cfg-codegen" style="display:none">
        <div class="f">
          <label>目标语言</label>
          <select id="json-codegen-lang">
            <option>TypeScript</option>
            <option>Swift</option>
            <option>Kotlin</option>
            <option>Java</option>
            <option>Go</option>
            <option>Python</option>
            <option>C#</option>
            <option>Dart</option>
            <option>Rust</option>
          </select>
        </div>
        <div class="f">
          <label>根类名</label>
          <input type="text" value="Root" id="json-codegen-class"/>
        </div>
      </div>
      
      <div class="cfg" id="json-cfg-path" style="display:none">
        <div class="f" style="grid-column:1/-1">
          <label>JSONPath 表达式</label>
          <input type="text" value="$.store.book[*].author" id="json-path-expr"/>
        </div>
      </div>
      
      <div class="io-g" id="json-io-normal">
        <div class="io">
          <div class="io-h">
            <div class="lb">
              <span class="dot" style="background:var(--yellow)"></span>
              输入 JSON
            </div>
            <div class="acts">
              <button onclick="document.getElementById('json-in').value=''">清空</button>
              <button onclick="navigator.clipboard.readText().then(t=>document.getElementById('json-in').value=t)">粘贴</button>
              <button onclick="document.getElementById('json-sample').click()">示例</button>
            </div>
          </div>
          <textarea id="json-in" style="min-height:300px" placeholder='粘贴或输入 JSON 数据...&#10;&#10;{&#10;  "name": "CryptoBox",&#10;  "version": "1.0",&#10;  "features": ["加密", "哈希", "编码"]&#10;}'></textarea>
          <div class="ftabs">
            <div class="ftab active">JSON</div>
            <div class="ftab">JSON String</div>
          </div>
        </div>
        <div class="io">
          <div class="io-h">
            <div class="lb">
              <span class="dot" style="background:var(--green)"></span>
              <span id="json-out-label">输出</span>
            </div>
            <div class="acts">
              <button onclick="navigator.clipboard.writeText(document.getElementById('json-out').textContent)">复制</button>
              <button onclick="let b=new Blob([document.getElementById('json-out').textContent],{type:'text/plain'});let a=document.createElement('a');a.href=URL.createObjectURL(b);a.download='output.json';a.click()">保存</button>
            </div>
          </div>
          <div class="out" id="json-out" style="min-height:300px;color:var(--yellow);white-space:pre-wrap;overflow:auto;user-select:all"></div>
          <div class="ft">
            <span id="json-status" style="color:var(--green)">✓ 就绪</span>
            &nbsp;·&nbsp; 行数: <span id="json-lines">0</span>
            &nbsp;·&nbsp; 大小: <span id="json-size">0 B</span>
          </div>
        </div>
      </div>
      
      <div class="ab">
        <button class="btn" id="json-run-btn" style="background:linear-gradient(135deg,var(--yellow),#ca8a04);color:#fff;box-shadow:0 4px 16px rgba(234,179,8,0.3)">
          <svg viewBox="0 0 24 24">
            <polygon points="5 3 19 12 5 21 5 3"/>
          </svg>
          <span id="json-run-text">格式化</span>
        </button>
        <button class="btn btn-o" id="json-validate-btn">
          <svg viewBox="0 0 24 24">
            <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
            <polyline points="22 4 12 14.01 9 11.01"/>
          </svg>
          校验 JSON
        </button>
        <button class="btn btn-o" id="json-minify-btn">
          <svg viewBox="0 0 24 24">
            <polyline points="4 14 10 14 10 20"/>
            <polyline points="20 10 14 10 14 4"/>
            <line x1="14" y1="10" x2="21" y2="3"/>
            <line x1="3" y1="21" x2="10" y2="14"/>
          </svg>
          压缩
        </button>
      </div>
      
      <button id="json-sample" style="display:none"></button>
    </div>
  </div>

  <!-- Base64 页面 -->
  <div class="content anim" id="page-base64" style="display:none">
    <div class="page-h">
      <h2>
        <span class="hi" style="background:rgba(0,255,255,0.12);color:var(--cyan)">
          <svg viewBox="0 0 24 24">
            <path d="M16 18l6-6-6-6"/>
            <path d="M8 6l-6 6 6 6"/>
          </svg>
        </span>
        Base64 / Base32 编解码
      </h2>
      <p>Base 系列编码 — 支持 Base64、Base64URL、Base32</p>
    </div>
    
    <div class="ws">
      <div class="pills">
        <button class="pill active">Base64</button>
        <button class="pill">Base64URL</button>
        <button class="pill">Base32</button>
      </div>
      
      <div class="cfg">
        <div class="f">
          <label>编码类型</label>
          <select id="base-type">
            <option selected>Base64</option>
            <option>Base64URL</option>
            <option>Base32</option>
          </select>
        </div>
        <div class="f">
          <label>操作</label>
          <select id="base-operation">
            <option selected>编码</option>
            <option>解码</option>
          </select>
        </div>
      </div>
      
      <div class="io-g">
        <div class="io">
          <div class="io-h">
            <div class="lb">
              <span class="dot" style="background:var(--cyan)"></span>
              输入
            </div>
            <div class="acts">
              <button>粘贴</button>
              <button>清空</button>
            </div>
          </div>
          <textarea id="base-input" placeholder="输入要编码/解码的内容..."></textarea>
          <div class="ftabs">
            <div class="ftab active">文本</div>
            <div class="ftab">文件</div>
          </div>
        </div>
        <div class="io">
          <div class="io-h">
            <div class="lb">
              <span class="dot" style="background:var(--green)"></span>
              输出
            </div>
            <div class="acts">
              <button>复制</button>
              <button>保存</button>
            </div>
          </div>
          <div class="out" id="base-output"></div>
          <div class="ft">
            长度: <span id="base-output-len">0</span>
          </div>
        </div>
      </div>
      
      <div class="ab">
        <button class="btn" id="base-encode" style="background:linear-gradient(135deg,var(--cyan),#0891b2);color:#fff">编码</button>
        <button class="btn btn-g" id="base-decode">解码</button>
        <button class="btn-sw" id="base-swap">
          <svg viewBox="0 0 24 24">
            <path d="M7 16V4m0 0L3 8m4-4l4 4M17 8v12m0 0l4-4m-4 4l-4-4"/>
          </svg>
        </button>
      </div>
    </div>
  </div>

  <!-- RSA 页面 -->
  <div class="content anim" id="page-rsa" style="display:none">
    <div class="page-h">
      <h2>
        <span class="hi" style="background:var(--green-g);color:var(--green)">
          <svg viewBox="0 0 24 24">
            <path d="M21 2l-2 2m-7.61 7.61a5.5 5.5 0 1 1-7.778 7.778 5.5 5.5 0 0 1 7.777-7.777zm0 0L15.5 7.5m0 0l3 3L22 7l-3-3m-3.5 3.5L19 4"/>
          </svg>
        </span>
        RSA 加解密 & 签名
      </h2>
      <p>非对称加密算法 — 支持加解密、数字签名与验签</p>
    </div>
    
    <div class="ws">
      <div class="pills">
        <button class="pill active" data-rsa-mode="encrypt">加解密</button>
        <button class="pill" data-rsa-mode="sign">签名验签</button>
      </div>
      
      <div id="rsa-encrypt-mode">
        <div class="cfg">
          <div class="f">
            <label>密钥长度</label>
            <select>
              <option>1024</option>
              <option selected>2048</option>
              <option>3072</option>
              <option>4096</option>
            </select>
          </div>
          <div class="f">
            <label>填充模式</label>
            <select>
              <option selected>OAEP</option>
              <option>PKCS1v15</option>
            </select>
          </div>
          <div class="f">
            <label>哈希算法</label>
            <select>
              <option selected>SHA-256</option>
              <option>SHA-1</option>
              <option>SHA-512</option>
            </select>
          </div>
        </div>
        
        <div class="io-g">
          <div class="io">
            <div class="io-h">
              <div class="lb">
                <span class="dot" style="background:var(--green)"></span>
                公钥 (PEM)
              </div>
            </div>
            <textarea id="rsa-public-key" style="min-height:120px" placeholder="-----BEGIN PUBLIC KEY-----&#10;...&#10;-----END PUBLIC KEY-----"></textarea>
          </div>
          <div class="io">
            <div class="io-h">
              <div class="lb">
                <span class="dot" style="background:var(--red)"></span>
                私钥 (PEM)
              </div>
            </div>
            <textarea id="rsa-private-key" style="min-height:120px" placeholder="-----BEGIN PRIVATE KEY-----&#10;...&#10;-----END PRIVATE KEY-----"></textarea>
          </div>
        </div>
        
        <div class="io-g">
          <div class="io">
            <div class="io-h">
              <div class="lb">
                <span class="dot" style="background:var(--accent)"></span>
                输入 (明文)
              </div>
            </div>
            <textarea id="rsa-encrypt-input" placeholder="输入要加密的内容..."></textarea>
          </div>
          <div class="io">
            <div class="io-h">
              <div class="lb">
                <span class="dot" style="background:var(--orange)"></span>
                输出 (密文)
              </div>
            </div>
            <div class="out" id="rsa-encrypt-output"></div>
          </div>
        </div>
      </div>
      
      <div class="ab">
        <button class="btn btn-p" id="rsa-generate-keys">
          <svg viewBox="0 0 24 24">
            <path d="M23 4v6h-6"/>
            <path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"/>
          </svg>
          生成密钥对
        </button>
        <button class="btn" id="rsa-encrypt-btn" style="background:linear-gradient(135deg,var(--green),#16a34a);color:#fff">加密</button>
        <button class="btn btn-g" id="rsa-decrypt-btn">解密</button>
      </div>
    </div>
  </div>

</main>

<!-- 历史记录面板 -->
<div id="history-panel" class="history-panel">
  <div class="history-header">
    <div class="history-title">
      <svg viewBox="0 0 24 24">
        <path d="M1 4v6h6"/>
        <path d="M3.51 15a9 9 0 1 0 2.13-9.36L1 10"/>
      </svg>
      <span>操作历史</span>
    </div>
    <div class="history-actions">
      <button id="history-export" class="history-btn" title="导出历史">
        <svg viewBox="0 0 24 24">
          <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
          <polyline points="7 10 12 15 17 10"/>
          <line x1="12" y1="15" x2="12" y2="3"/>
        </svg>
      </button>
      <button id="history-import" class="history-btn" title="导入历史">
        <svg viewBox="0 0 24 24">
          <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
          <polyline points="17 8 12 3 7 8"/>
          <line x1="12" y1="3" x2="12" y2="15"/>
        </svg>
      </button>
      <button id="history-clear" class="history-btn" title="清空全部">
        <svg viewBox="0 0 24 24">
          <polyline points="3 6 5 6 21 6"/>
          <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>
        </svg>
      </button>
      <button id="history-close" class="history-btn" title="关闭">
        <svg viewBox="0 0 24 24">
          <line x1="18" y1="6" x2="6" y2="18"/>
          <line x1="6" y1="6" x2="18" y2="18"/>
        </svg>
      </button>
    </div>
  </div>
  
  <div class="history-filters">
    <div class="filter-row">
      <select id="history-module-filter">
        <option value="">全部模块</option>
        <option value="AES">AES</option>
        <option value="DES">DES/3DES</option>
        <option value="RSA">RSA</option>
        <option value="ECC">ECC</option>
        <option value="Hash">Hash</option>
        <option value="HMAC">HMAC</option>
        <option value="Base64">Base64</option>
        <option value="JWT">JWT</option>
        <option value="JSON">JSON</option>
        <option value="SM2">SM2</option>
        <option value="SM4">SM4</option>
      </select>
      <select id="history-action-filter">
        <option value="">全部操作</option>
        <option value="encrypt">加密</option>
        <option value="decrypt">解密</option>
        <option value="hash">哈希</option>
        <option value="sign">签名</option>
        <option value="verify">验证</option>
        <option value="encode">编码</option>
        <option value="decode">解码</option>
        <option value="format">格式化</option>
        <option value="generate">生成</option>
      </select>
    </div>
    <div class="search-row">
      <input type="text" id="history-search" placeholder="搜索输入输出内容..." />
      <svg class="search-icon" viewBox="0 0 24 24">
        <circle cx="11" cy="11" r="8"/>
        <path d="m21 21-4.35-4.35"/>
      </svg>
    </div>
  </div>
  
  <div class="history-list" id="history-list">
    <div class="history-empty">
      <svg viewBox="0 0 24 24">
        <path d="M1 4v6h6"/>
        <path d="M3.51 15a9 9 0 1 0 2.13-9.36L1 10"/>
      </svg>
      <p>暂无操作记录</p>
      <span>使用工具后操作记录将显示在这里</span>
    </div>
  </div>
  
  <div class="history-stats">
    <div class="stat-item">
      <span class="stat-label">总操作</span>
      <span class="stat-value" id="history-total-count">0</span>
    </div>
    <div class="stat-item">
      <span class="stat-label">今日操作</span>
      <span class="stat-value" id="history-today-count">0</span>
    </div>
    <div class="stat-item">
      <span class="stat-label">常用模块</span>
      <span class="stat-value" id="history-top-module">-</span>
    </div>
  </div>
</div>

<!-- 历史面板背景遮罩 -->
<div id="history-overlay" class="history-overlay"></div>
</div>

<script>
// ═══ 全局变量和工具函数 ═══
let currentTheme = 'dark';
let debounceTimers = {};

// Toast 通知系统
function showToast(message, type = 'info', duration = 3000) {
  const container = document.getElementById('toast-container');
  const toast = document.createElement('div');
  toast.className = `toast ${type}`;
  
  const icons = {
    success: '<svg viewBox="0 0 24 24"><polyline points="20 6 9 17 4 12"/></svg>',
    error: '<svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><line x1="15" y1="9" x2="9" y2="15"/><line x1="9" y1="9" x2="15" y2="15"/></svg>',
    info: '<svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><line x1="12" y1="16" x2="12" y2="12"/><line x1="12" y1="8" x2="12.01" y2="8"/></svg>'
  };
  
  toast.innerHTML = `
    <div class="toast-icon">${icons[type] || icons.info}</div>
    <div class="toast-text">${message}</div>
    <div class="toast-close">×</div>
  `;
  
  container.appendChild(toast);
  
  // 显示动画
  setTimeout(() => toast.classList.add('show'), 10);
  
  // 自动消失
  const hideToast = () => {
    toast.classList.remove('show');
    setTimeout(() => container.removeChild(toast), 300);
  };
  
  const timer = setTimeout(hideToast, duration);
  
  // 点击关闭
  toast.querySelector('.toast-close').addEventListener('click', () => {
    clearTimeout(timer);
    hideToast();
  });
}

// 防抖函数
function debounce(key, func, delay = 300) {
  clearTimeout(debounceTimers[key]);
  debounceTimers[key] = setTimeout(func, delay);
}

// 按钮 Loading 状态管理
function setButtonLoading(button, loading = true) {
  if (loading) {
    button.classList.add('loading');
    button.disabled = true;
  } else {
    button.classList.remove('loading');
    button.disabled = false;
  }
}

// 输出区域闪烁高亮效果
function flashOutputArea(elementId) {
  const element = document.getElementById(elementId);
  if (element) {
    element.classList.remove('output-flash');
    void element.offsetWidth; // 强制重排
    element.classList.add('output-flash');
    setTimeout(() => {
      element.classList.remove('output-flash');
    }, 800);
  }
}

// 增强的输出设置函数（带动画）
function setOutputWithAnimation(elementId, text, success = true) {
  const element = document.getElementById(elementId);
  if (element) {
    // 淡出当前内容
    element.style.opacity = '0.6';
    element.style.transform = 'scale(0.98)';
    
    setTimeout(() => {
      // 更新内容
      element.textContent = text;
      element.style.color = success ? 'var(--green-light)' : 'var(--red)';
      
      // 淡入新内容
      element.style.opacity = '1';
      element.style.transform = 'scale(1)';
      
      // 添加flash效果
      flashOutputArea(elementId);
    }, 150);
  }
}

// ═══ 历史记录管理器 ═══
const HistoryManager = {
  STORAGE_KEY: 'cryptobox_history',
  MAX_RECORDS: 500,
  unreadCount: 0,
  
  // 添加历史记录
  add(record) {
    try {
      const id = Date.now() + '_' + Math.random().toString(36).substr(2, 9);
      const historyRecord = {
        id,
        timestamp: Date.now(),
        module: record.module || 'Unknown',
        action: record.action || 'unknown',
        params: record.params || {},
        input: this.truncateText(record.input || '', 200),
        output: this.truncateText(record.output || '', 200),
        success: record.success !== false,
        ...record
      };
      
      const records = this.getAll();
      records.unshift(historyRecord);
      
      // 保持最大记录数限制
      if (records.length > this.MAX_RECORDS) {
        records.splice(this.MAX_RECORDS);
      }
      
      localStorage.setItem(this.STORAGE_KEY, JSON.stringify(records));
      
      // 增加未读计数
      this.unreadCount++;
      this.updateBadge();
      
      return historyRecord;
    } catch (error) {
      console.error('添加历史记录失败:', error);
      return null;
    }
  },
  
  // 获取所有记录
  getAll(filters = {}) {
    try {
      const records = JSON.parse(localStorage.getItem(this.STORAGE_KEY) || '[]');
      return this.filterRecords(records, filters);
    } catch (error) {
      console.error('读取历史记录失败:', error);
      return [];
    }
  },
  
  // 删除单条记录
  remove(id) {
    try {
      const records = this.getAll();
      const filtered = records.filter(r => r.id !== id);
      localStorage.setItem(this.STORAGE_KEY, JSON.stringify(filtered));
      this.renderHistory();
      this.updateStats();
      return true;
    } catch (error) {
      console.error('删除历史记录失败:', error);
      return false;
    }
  },
  
  // 清空所有记录
  clear() {
    try {
      localStorage.removeItem(this.STORAGE_KEY);
      this.unreadCount = 0;
      this.updateBadge();
      this.renderHistory();
      this.updateStats();
      showToast('已清空所有历史记录', 'info');
      return true;
    } catch (error) {
      console.error('清空历史记录失败:', error);
      return false;
    }
  },
  
  // 截取文本
  truncateText(text, maxLength) {
    if (!text || typeof text !== 'string') return '';
    return text.length > maxLength ? text.substring(0, maxLength) + '...' : text;
  },
  
  // 时间格式化
  formatTimeAgo(timestamp) {
    const now = Date.now();
    const diff = now - timestamp;
    const minutes = Math.floor(diff / 60000);
    const hours = Math.floor(diff / 3600000);
    const days = Math.floor(diff / 86400000);
    
    if (minutes < 1) return '刚刚';
    if (minutes < 60) return `${minutes}分钟前`;
    if (hours < 24) return `${hours}小时前`;
    if (days < 30) return `${days}天前`;
    return new Date(timestamp).toLocaleDateString('zh-CN');
  },
  
  // 更新未读徽章
  updateBadge() {
    const badge = document.getElementById('history-badge');
    if (badge) {
      if (this.unreadCount > 0) {
        badge.textContent = this.unreadCount > 99 ? '99+' : this.unreadCount;
        badge.style.display = '';
      } else {
        badge.style.display = 'none';
      }
    }
  },
  
  // 清零未读计数
  clearUnread() {
    this.unreadCount = 0;
    this.updateBadge();
  },
  
  // 筛选记录
  filterRecords(records, filters) {
    let filtered = [...records];
    
    if (filters.module) {
      filtered = filtered.filter(r => r.module === filters.module);
    }
    
    if (filters.action) {
      filtered = filtered.filter(r => r.action === filters.action);
    }
    
    if (filters.search) {
      const search = filters.search.toLowerCase();
      filtered = filtered.filter(r => 
        r.input.toLowerCase().includes(search) ||
        r.output.toLowerCase().includes(search) ||
        r.module.toLowerCase().includes(search)
      );
    }
    
    return filtered;
  },
  
  // 渲染历史记录列表
  renderHistory() {
    const container = document.getElementById('history-list');
    if (!container) return;
    
    const moduleFilter = document.getElementById('history-module-filter')?.value || '';
    const actionFilter = document.getElementById('history-action-filter')?.value || '';
    const searchFilter = document.getElementById('history-search')?.value || '';
    
    const filters = { 
      module: moduleFilter || undefined, 
      action: actionFilter || undefined,
      search: searchFilter || undefined
    };
    
    const records = this.getAll(filters);
    
    if (records.length === 0) {
      container.innerHTML = `
        <div class="history-empty">
          <svg viewBox="0 0 24 24">
            <path d="M1 4v6h6"/>
            <path d="M3.51 15a9 9 0 1 0 2.13-9.36L1 10"/>
          </svg>
          <p>暂无操作记录</p>
          <span>使用工具后操作记录将显示在这里</span>
        </div>
      `;
      return;
    }
    
    const html = records.map(record => this.renderHistoryItem(record)).join('');
    container.innerHTML = html;
  },
  
  // 渲染单个历史记录项
  renderHistoryItem(record) {
    const moduleClass = record.module.toLowerCase();
    const statusIcon = record.success 
      ? '<svg class="status-icon success" viewBox="0 0 24 24"><polyline points="20 6 9 17 4 12"/></svg>'
      : '<svg class="status-icon error" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><line x1="15" y1="9" x2="9" y2="15"/><line x1="9" y1="9" x2="15" y2="15"/></svg>';
    
    const actionText = this.getActionText(record.action);
    
    return `
      <div class="history-item" data-id="${record.id}">
        <div class="history-item-header">
          <div class="module-badge ${moduleClass}">
            <div class="module-icon"></div>
            ${record.module}
          </div>
          <div class="operation-desc">${record.module} ${actionText}</div>
          <div class="history-time">${this.formatTimeAgo(record.timestamp)}</div>
          ${statusIcon}
        </div>
        <div class="history-preview">
          <div class="preview-item">
            <div class="preview-label">输入</div>
            ${this.truncateText(record.input, 60)}
          </div>
          <div class="preview-item">
            <div class="preview-label">输出</div>
            ${this.truncateText(record.output, 60)}
          </div>
        </div>
      </div>
    `;
  },
  
  // 格式化操作类型文本
  getActionText(action) {
    const actionMap = {
      encrypt: '加密',
      decrypt: '解密',
      hash: '哈希计算',
      sign: '数字签名',
      verify: '验证签名',
      encode: '编码',
      decode: '解码',
      format: '格式化',
      compress: '压缩',
      generate: '生成密钥'
    };
    return actionMap[action] || action;
  },
  
  // 更新统计信息
  updateStats() {
    const stats = this.getStats();
    
    const totalElement = document.getElementById('history-total-count');
    const todayElement = document.getElementById('history-today-count');
    const topModuleElement = document.getElementById('history-top-module');
    
    if (totalElement) totalElement.textContent = stats.totalCount;
    if (todayElement) todayElement.textContent = stats.todayCount;
    if (topModuleElement) {
      topModuleElement.textContent = stats.topModules.length > 0 
        ? stats.topModules[0].module 
        : '-';
    }
  },
  
  // 获取统计信息
  getStats() {
    const records = this.getAll();
    const today = new Date().toDateString();
    
    // 今日操作次数
    const todayCount = records.filter(r => 
      new Date(r.timestamp).toDateString() === today
    ).length;
    
    // 模块统计
    const moduleStats = {};
    records.forEach(r => {
      moduleStats[r.module] = (moduleStats[r.module] || 0) + 1;
    });
    
    // 最常用模块 Top 3
    const topModules = Object.entries(moduleStats)
      .sort(([,a], [,b]) => b - a)
      .slice(0, 3)
      .map(([module, count]) => ({ module, count }));
    
    return {
      totalCount: records.length,
      todayCount,
      topModules,
      successRate: records.filter(r => r.success).length / Math.max(records.length, 1)
    };
  },
  
  // 显示历史面板
  showPanel() {
    const panel = document.getElementById('history-panel');
    const overlay = document.getElementById('history-overlay');
    
    if (panel && overlay) {
      panel.classList.add('show');
      overlay.classList.add('show');
      this.clearUnread();
      this.renderHistory();
      this.updateStats();
    }
  },
  
  // 隐藏历史面板
  hidePanel() {
    const panel = document.getElementById('history-panel');
    const overlay = document.getElementById('history-overlay');
    
    if (panel && overlay) {
      panel.classList.remove('show');
      overlay.classList.remove('show');
    }
  },
  
  // 初始化历史记录功能
  init() {
    const historyToggle = document.getElementById('history-toggle');
    const historyClose = document.getElementById('history-close');
    const historyOverlay = document.getElementById('history-overlay');
    const historyClear = document.getElementById('history-clear');
    
    if (historyToggle) {
      historyToggle.addEventListener('click', () => this.showPanel());
    }
    
    if (historyClose) {
      historyClose.addEventListener('click', () => this.hidePanel());
    }
    
    if (historyOverlay) {
      historyOverlay.addEventListener('click', () => this.hidePanel());
    }
    
    if (historyClear) {
      historyClear.addEventListener('click', () => {
        if (confirm('确定要清空所有历史记录吗？此操作不可恢复。')) {
          this.clear();
        }
      });
    }
    
    // 绑定筛选事件
    const moduleFilter = document.getElementById('history-module-filter');
    const actionFilter = document.getElementById('history-action-filter');
    const searchFilter = document.getElementById('history-search');
    
    if (moduleFilter) {
      moduleFilter.addEventListener('change', () => this.renderHistory());
    }
    
    if (actionFilter) {
      actionFilter.addEventListener('change', () => this.renderHistory());
    }
    
    if (searchFilter) {
      searchFilter.addEventListener('input', () => {
        debounce('history-search', () => {
          this.renderHistory();
        }, 300);
      });
    }
    
    console.log('📚 历史记录管理器已初始化');
  }
};

// ═══ 页面导航系统 ═══
const PageManager = {
  currentPage: 'home',
  
  init() {
    // 绑定导航项点击事件
    document.querySelectorAll('.nav-i[data-page]').forEach(navItem => {
      navItem.addEventListener('click', (e) => {
        e.preventDefault();
        const page = navItem.dataset.page;
        this.goToPage(page);
      });
    });
    
    // 绑定卡片点击事件
    document.querySelectorAll('.cat-card[data-goto]').forEach(card => {
      card.addEventListener('click', (e) => {
        e.preventDefault();
        const page = card.dataset.goto;
        this.goToPage(page);
      });
    });
    
    console.log('🧭 页面导航系统已初始化');
  },
  
  goToPage(page) {
    if (page === this.currentPage) return;
    
    // 更新导航状态
    this.updateNavigation(page);
    
    // 隐藏当前页面
    const currentPageEl = document.getElementById(`page-${this.currentPage}`);
    if (currentPageEl) {
      currentPageEl.style.display = 'none';
    }
    
    // 显示目标页面
    const targetPageEl = document.getElementById(`page-${page}`);
    if (targetPageEl) {
      targetPageEl.style.display = 'block';
      targetPageEl.classList.add('anim');
    }
    
    // 更新面包屑
    this.updateBreadcrumb(page);
    
    // 更新当前页面
    this.currentPage = page;
  },
  
  updateNavigation(page) {
    // 移除所有active状态
    document.querySelectorAll('.nav-i').forEach(item => {
      item.classList.remove('active');
    });
    
    // 添加新的active状态
    const targetNav = document.querySelector(`[data-page="${page}"]`);
    if (targetNav) {
      targetNav.classList.add('active');
    }
  },
  
  updateBreadcrumb(page) {
    const bcCur = document.getElementById('bcCur');
    const pageNames = {
      'home': '工作台',
      'aes': 'AES 加解密',
      'des': 'DES / 3DES',
      'chacha20': 'ChaCha20',
      'blowfish': 'Blowfish',
      'rc4': 'RC4',
      'sm4': 'SM4 国密',
      'rsa': 'RSA',
      'ecc': 'ECC / ECDSA',
      'ed25519': 'Ed25519',
      'sm2': 'SM2 国密',
      'hash': '哈希计算',
      'hmac': 'HMAC',
      'password': '密码哈希',
      'base64': 'Base64 / Base32',
      'hex': 'Hex / URL',
      'jwt': 'JWT',
      'json': 'JSON 工具',
      'keygen': '密钥生成器',
      'cert': '证书工具',
      'compare': '对比工具'
    };
    
    if (bcCur && pageNames[page]) {
      bcCur.textContent = pageNames[page];
    }
  }
};

// ═══ 主题切换 ═══
const ThemeManager = {
  init() {
    const themeToggle = document.getElementById('theme-toggle');
    const themeText = document.getElementById('theme-text');
    
    if (themeToggle) {
      themeToggle.addEventListener('click', () => {
        currentTheme = currentTheme === 'dark' ? 'light' : 'dark';
        document.documentElement.setAttribute('data-theme', currentTheme);
        
        if (themeText) {
          themeText.textContent = currentTheme === 'dark' ? '暗色' : '亮色';
        }
        
        // 保存主题设置
        localStorage.setItem('cryptobox_theme', currentTheme);
        
        showToast(`已切换到${currentTheme === 'dark' ? '暗色' : '亮色'}主题`, 'info');
      });
    }
    
    // 加载保存的主题
    const savedTheme = localStorage.getItem('cryptobox_theme');
    if (savedTheme) {
      currentTheme = savedTheme;
      document.documentElement.setAttribute('data-theme', currentTheme);
      if (themeText) {
        themeText.textContent = currentTheme === 'dark' ? '暗色' : '亮色';
      }
    }
    
    console.log('🎨 主题管理器已初始化');
  }
};

// ═══ 哈希计算功能 ═══
const HashCalculator = {
  init() {
    const hashCompute = document.getElementById('hash-compute');
    const hashInput = document.getElementById('hash-input');
    
    if (hashCompute && hashInput) {
      hashCompute.addEventListener('click', () => {
        const input = hashInput.value.trim();
        if (!input) {
          showToast('请输入要计算的内容', 'error');
          return;
        }
        
        this.computeAllHashes(input);
      });
    }
    
    // 绑定复制按钮
    document.querySelectorAll('[data-hash]').forEach(btn => {
      btn.addEventListener('click', (e) => {
        const hashType = e.target.dataset.hash;
        const hashValue = document.getElementById(`hash-${hashType}`)?.textContent;
        
        if (hashValue && hashValue !== '点击计算哈希显示结果') {
          navigator.clipboard.writeText(hashValue).then(() => {
            showToast(`已复制 ${hashType.toUpperCase()} 哈希值`, 'success');
          });
        }
      });
    });
    
    console.log('🔐 哈希计算器已初始化');
  },
  
  computeAllHashes(input) {
    try {
      const startTime = Date.now();
      
      // MD5
      const md5Hash = CryptoJS.MD5(input).toString();
      document.getElementById('hash-md5').textContent = md5Hash;
      
      // SHA-1
      const sha1Hash = CryptoJS.SHA1(input).toString();
      document.getElementById('hash-sha1').textContent = sha1Hash;
      
      // SHA-256
      const sha256Hash = CryptoJS.SHA256(input).toString();
      document.getElementById('hash-sha256').textContent = sha256Hash;
      
      // SHA-512
      const sha512Hash = CryptoJS.SHA512(input).toString();
      document.getElementById('hash-sha512').textContent = sha512Hash;
      
      // SHA-3 (如果可用)
      if (typeof sha3_256 !== 'undefined') {
        const sha3Hash = sha3_256(input);
        document.getElementById('hash-sha3').textContent = sha3Hash;
      } else {
        document.getElementById('hash-sha3').textContent = '库未加载';
      }
      
      // SM3 (如果可用)
      if (typeof smCrypto !== 'undefined' && smCrypto.sm3) {
        const sm3Hash = smCrypto.sm3(input);
        document.getElementById('hash-sm3').textContent = sm3Hash;
      } else {
        document.getElementById('hash-sm3').textContent = '库未加载';
      }
      
      // BLAKE2b (如果可用)
      if (typeof blake2b !== 'undefined') {
        const blake2bHash = blake2b(64).update(new TextEncoder().encode(input)).digest('hex');
        document.getElementById('hash-blake2b').textContent = blake2bHash;
      } else {
        document.getElementById('hash-blake2b').textContent = '库未加载';
      }
      
      // BLAKE3 (如果可用)
      if (typeof blake3 !== 'undefined') {
        const blake3Hash = blake3.hash(input);
        document.getElementById('hash-blake3').textContent = blake3Hash;
      } else {
        document.getElementById('hash-blake3').textContent = '库未加载';
      }
      
      const endTime = Date.now();
      
      // 添加到历史记录
      HistoryManager.add({
        module: 'Hash',
        action: 'hash',
        input: input,
        output: `MD5: ${md5Hash.substring(0, 16)}...\nSHA-256: ${sha256Hash.substring(0, 16)}...`,
        params: {
          algorithms: 'ALL',
          inputLength: input.length
        },
        success: true
      });
      
      showToast(`哈希计算完成，耗时 ${endTime - startTime}ms`, 'success');
    } catch (error) {
      console.error('哈希计算失败:', error);
      showToast('哈希计算失败: ' + error.message, 'error');
    }
  }
};

// ═══ JSON 工具功能 ═══
const JsonTool = {
  currentTab: 'format',
  
  init() {
    // 绑定标签页切换
    document.querySelectorAll('[data-jtab]').forEach(tab => {
      tab.addEventListener('click', (e) => {
        const tabName = e.target.dataset.jtab;
        this.switchTab(tabName);
      });
    });
    
    // 绑定运行按钮
    const runBtn = document.getElementById('json-run-btn');
    if (runBtn) {
      runBtn.addEventListener('click', () => {
        this.runCurrentOperation();
      });
    }
    
    // 绑定校验按钮
    const validateBtn = document.getElementById('json-validate-btn');
    if (validateBtn) {
      validateBtn.addEventListener('click', () => {
        this.validateJson();
      });
    }
    
    console.log('📄 JSON 工具已初始化');
  },
  
  switchTab(tabName) {
    this.currentTab = tabName;
    
    // 更新标签状态
    document.querySelectorAll('[data-jtab]').forEach(tab => {
      tab.classList.toggle('active', tab.dataset.jtab === tabName);
    });
    
    // 隐藏所有配置区域
    document.querySelectorAll('[id^="json-cfg-"]').forEach(cfg => {
      cfg.style.display = 'none';
    });
    
    // 显示对应配置
    const targetCfg = document.getElementById(`json-cfg-${tabName}`);
    if (targetCfg) {
      targetCfg.style.display = 'grid';
    }
    
    // 更新运行按钮文本
    const runText = document.getElementById('json-run-text');
    const buttonTexts = {
      format: '格式化',
      compress: '压缩',
      escape: '转义',
      tree: '树形视图',
      convert: '转换',
      codegen: '生成代码',
      diff: '对比',
      path: '查询'
    };
    
    if (runText && buttonTexts[tabName]) {
      runText.textContent = buttonTexts[tabName];
    }
  },
  
  runCurrentOperation() {
    const input = document.getElementById('json-in')?.value.trim();
    if (!input) {
      showToast('请输入 JSON 内容', 'error');
      return;
    }
    
    try {
      switch (this.currentTab) {
        case 'format':
          this.formatJson(input);
          break;
        case 'compress':
          this.compressJson(input);
          break;
        default:
          showToast('该功能正在开发中', 'info');
      }
    } catch (error) {
      showToast('操作失败: ' + error.message, 'error');
    }
  },
  
  formatJson(input) {
    try {
      const parsed = JSON.parse(input);
      const indent = document.getElementById('json-indent')?.value || '2';
      const indentStr = indent === 't' ? '\t' : ' '.repeat(parseInt(indent));
      
      const formatted = JSON.stringify(parsed, null, indentStr);
      
      document.getElementById('json-out').textContent = formatted;
      document.getElementById('json-status').textContent = '✓ 格式化成功';
      document.getElementById('json-lines').textContent = formatted.split('\n').length;
      document.getElementById('json-size').textContent = new Blob([formatted]).size + ' B';
      
      // 添加到历史记录
      HistoryManager.add({
        module: 'JSON',
        action: 'format',
        input: input,
        output: formatted.substring(0, 200) + (formatted.length > 200 ? '...' : ''),
        params: { indent: indent },
        success: true
      });
      
      showToast('JSON 格式化成功', 'success');
    } catch (error) {
      document.getElementById('json-status').textContent = '✗ 格式错误';
      showToast('JSON 格式错误: ' + error.message, 'error');
    }
  },
  
  compressJson(input) {
    try {
      const parsed = JSON.parse(input);
      const compressed = JSON.stringify(parsed);
      
      document.getElementById('json-out').textContent = compressed;
      document.getElementById('json-status').textContent = '✓ 压缩成功';
      document.getElementById('json-lines').textContent = '1';
      document.getElementById('json-size').textContent = new Blob([compressed]).size + ' B';
      
      showToast('JSON 压缩成功', 'success');
    } catch (error) {
      showToast('JSON 格式错误: ' + error.message, 'error');
    }
  },
  
  validateJson() {
    const input = document.getElementById('json-in')?.value.trim();
    if (!input) {
      showToast('请输入 JSON 内容', 'error');
      return;
    }
    
    try {
      JSON.parse(input);
      document.getElementById('json-status').textContent = '✓ JSON 格式正确';
      showToast('JSON 格式正确', 'success');
    } catch (error) {
      document.getElementById('json-status').textContent = '✗ JSON 格式错误';
      showToast('JSON 格式错误: ' + error.message, 'error');
    }
  }
};

// ═══ Base64 编解码功能 ═══
const Base64Tool = {
  init() {
    const encodeBtn = document.getElementById('base-encode');
    const decodeBtn = document.getElementById('base-decode');
    
    if (encodeBtn) {
      encodeBtn.addEventListener('click', () => this.encode());
    }
    
    if (decodeBtn) {
      decodeBtn.addEventListener('click', () => this.decode());
    }
    
    console.log('🔢 Base64 工具已初始化');
  },
  
  encode() {
    const input = document.getElementById('base-input')?.value.trim();
    if (!input) {
      showToast('请输入要编码的内容', 'error');
      return;
    }
    
    try {
      const encoded = btoa(unescape(encodeURIComponent(input)));
      document.getElementById('base-output').textContent = encoded;
      document.getElementById('base-output-len').textContent = encoded.length;
      
      HistoryManager.add({
        module: 'Base64',
        action: 'encode',
        input: input,
        output: encoded,
        success: true
      });
      
      showToast('Base64 编码成功', 'success');
    } catch (error) {
      showToast('编码失败: ' + error.message, 'error');
    }
  },
  
  decode() {
    const input = document.getElementById('base-input')?.value.trim();
    if (!input) {
      showToast('请输入要解码的内容', 'error');
      return;
    }
    
    try {
      const decoded = decodeURIComponent(escape(atob(input)));
      document.getElementById('base-output').textContent = decoded;
      document.getElementById('base-output-len').textContent = decoded.length;
      
      HistoryManager.add({
        module: 'Base64',
        action: 'decode',
        input: input,
        output: decoded,
        success: true
      });
      
      showToast('Base64 解码成功', 'success');
    } catch (error) {
      showToast('解码失败，请检查输入格式', 'error');
    }
  }
};

// ═══ 搜索功能 ═══
const SearchManager = {
  init() {
    const searchInput = document.getElementById('searchInput');
    
    if (searchInput) {
      searchInput.addEventListener('input', (e) => {
        const query = e.target.value.toLowerCase().trim();
        this.performSearch(query);
      });
    }
    
    console.log('🔍 搜索管理器已初始化');
  },
  
  performSearch(query) {
    const navItems = document.querySelectorAll('.nav-i[data-page]');
    
    navItems.forEach(item => {
      const text = item.textContent.toLowerCase();
      const isMatch = text.includes(query) || query === '';
      
      item.style.display = isMatch ? 'flex' : 'none';
      
      // 高亮搜索关键词
      if (query && isMatch) {
        const span = item.querySelector('span:last-child');
        if (span) {
          const originalText = span.textContent;
          const highlightedText = originalText.replace(
            new RegExp(query, 'gi'),
            `<span class="search-highlight">$&</span>`
          );
          span.innerHTML = highlightedText;
        }
      } else {
        const span = item.querySelector('span:last-child');
        if (span) {
          span.innerHTML = span.textContent;
        }
      }
    });
  }
};

// ═══ 单元测试系统 ═══ 
function runAllTests() {
  console.log('🧪 开始运行单元测试...');
  
  const tests = [
    { name: 'Hash计算测试', fn: testHashCalculation },
    { name: 'Base64编码测试', fn: testBase64Encoding },
    { name: 'JSON格式化测试', fn: testJsonFormatting },
    { name: '主题切换测试', fn: testThemeToggle },
    { name: '页面导航测试', fn: testPageNavigation }
  ];
  
  let passed = 0;
  let failed = 0;
  
  tests.forEach((test, index) => {
    try {
      test.fn();
      console.log(`✅ ${test.name} 通过`);
      passed++;
    } catch (error) {
      console.error(`❌ ${test.name} 失败:`, error);
      failed++;
    }
  });
  
  const total = tests.length;
  console.log(`🏁 测试完成: ${passed}/${total} 通过, ${failed} 失败`);
  
  showToast(`测试完成: ${passed}/${total} 通过`, failed === 0 ? 'success' : 'error');
}

function testHashCalculation() {
  const testInput = 'Hello World';
  const expectedMd5 = 'b10a8db164e0754105b7a99be72e3fe5';
  const actualMd5 = CryptoJS.MD5(testInput).toString();
  
  if (actualMd5 !== expectedMd5) {
    throw new Error(`MD5哈希不匹配: 期望 ${expectedMd5}, 实际 ${actualMd5}`);
  }
}

function testBase64Encoding() {
  const testInput = 'Hello World';
  const expectedOutput = 'SGVsbG8gV29ybGQ=';
  const actualOutput = btoa(testInput);
  
  if (actualOutput !== expectedOutput) {
    throw new Error(`Base64编码不匹配: 期望 ${expectedOutput}, 实际 ${actualOutput}`);
  }
}

function testJsonFormatting() {
  const testJson = '{"name":"test","value":123}';
  const parsed = JSON.parse(testJson);
  const formatted = JSON.stringify(parsed, null, 2);
  
  if (!formatted.includes('\n')) {
    throw new Error('JSON格式化失败');
  }
}

function testThemeToggle() {
  const currentTheme = document.documentElement.getAttribute('data-theme');
  if (currentTheme !== 'dark' && currentTheme !== 'light') {
    throw new Error('主题状态异常');
  }
}

function testPageNavigation() {
  const homeNav = document.querySelector('[data-page="home"]');
  if (!homeNav || !homeNav.classList.contains('active')) {
    throw new Error('页面导航状态异常');
  }
}

// ═══ 应用初始化 ═══
document.addEventListener('DOMContentLoaded', function() {
  console.log('🚀 CryptoBox 应用启动中...');
  
  // 初始化各个模块
  HistoryManager.init();
  PageManager.init();
  ThemeManager.init();
  HashCalculator.init();
  JsonTool.init();
  Base64Tool.init();
  SearchManager.init();
  
  // 显示欢迎信息
  setTimeout(() => {
    showToast('欢迎使用 CryptoBox！', 'info', 2000);
  }, 500);
  
  console.log('✅ CryptoBox 应用初始化完成');
});

// 防止右键菜单和开发者工具（可选）
// document.addEventListener('contextmenu', e => e.preventDefault());
// document.addEventListener('keydown', e => {
//   if (e.key === 'F12' || (e.ctrlKey && e.shiftKey && e.key === 'I')) {
//     e.preventDefault();
//   }
// });
</script>

</body>
</html>